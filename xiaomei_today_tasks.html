<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AION 小美任务</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: 70px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo img {
            height: 40px;
        }

        .logo h1 {
            font-size: 22px;
            font-weight: 600;
            color: #2c3e50;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .search-bar {
            display: flex;
            align-items: center;
            background-color: #f5f7fa;
            border-radius: 20px;
            padding: 8px 15px;
            width: 300px;
        }

        .search-bar input {
            border: none;
            background: none;
            outline: none;
            width: 100%;
            margin-left: 8px;
            font-size: 14px;
        }

        .breadcrumb {
            position: fixed;
            top: 70px;
            left: 240px;
            right: 0;
            background-color: #fff;
            padding: 15px 30px;
            border-bottom: 1px solid #e9ecef;
            z-index: 999;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .breadcrumb a {
            color: #3498db;
            text-decoration: none;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .breadcrumb a:hover {
            color: #2980b9;
        }

        .breadcrumb i {
            font-size: 12px;
            color: #95a5a6;
        }

        .breadcrumb span {
            color: #7f8c8d;
            font-size: 14px;
        }

        .side-nav {
            position: fixed;
            left: 0;
            top: 0;
            width: 240px;
            height: 100vh;
            background-color: #fff;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            padding-top: 90px;
            z-index: 90;
        }

        .nav-section-title {
            padding: 15px 25px;
            font-size: 14px;
            color: #666;
            font-weight: 500;
            background-color: #f8f9fa;
            margin: 10px 0;
        }

        .nav-child {
            padding-left: 45px;
        }

        .nav-item {
            padding: 12px 25px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #2c3e50;
            text-decoration: none;
        }

        .nav-item:hover {
            background-color: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }

        .nav-item.active {
            background-color: rgba(52, 152, 219, 0.1);
            color: #3498db;
            border-right: 3px solid #3498db;
        }

        .nav-item i {
            margin-right: 12px;
            width: 20px;
            text-align: center;
        }

        .main-container {
            margin-left: 240px;
            padding: 190px 24px 24px;
            max-width: 1400px;
        }

        .dashboard-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        /* 策略管理区域样式 */
        .strategy-control-section {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }

        .strategy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .strategy-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50;
        }

        .strategy-title i {
            color: #3498db;
        }

        .concurrent-control {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .concurrent-label {
            font-size: 14px;
            color: #666;
        }

        .concurrent-value {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            padding: 4px 12px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }

        .upgrade-btn {
            padding: 6px 12px;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
        }

        .upgrade-btn:hover {
            background-color: #27ae60;
        }

        .strategy-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .strategy-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .strategy-tag {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background-color: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .strategy-tag:hover {
            border-color: #3498db;
            background-color: #f1f9ff;
        }

        .tag-label {
            font-size: 13px;
            color: #666;
        }

        .tag-value {
            font-size: 13px;
            font-weight: 500;
            color: #2c3e50;
            padding: 2px 8px;
            background-color: white;
            border-radius: 4px;
        }

        .edit-tag-btn {
            padding: 4px;
            background: none;
            border: none;
            color: #95a5a6;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .edit-tag-btn:hover {
            color: #3498db;
        }

        .strategy-tag.priority-tag .tag-value {
            color: #e74c3c;
            background-color: #fff5f5;
        }

        .strategy-tag.identity-tag .tag-value {
            color: #3498db;
            background-color: #f1f9ff;
        }

        .strategy-tag.dialect-tag .tag-value {
            color: #2ecc71;
            background-color: #f0fff4;
        }

        .strategy-tag.knowledge-tag .tag-value {
            color: #f39c12;
            background-color: #fff9f0;
        }

        .strategy-tag.rpa-tag .tag-value {
            color: #9b59b6;
            background-color: #faf5ff;
        }

        .strategy-actions {
            display: flex;
            justify-content: flex-end;
        }

        .change-strategy-btn {
            padding: 8px 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .change-strategy-btn:hover {
            background-color: #2980b9;
        }

        /* 左上角缩小版的interaction统计数据 */
        .mini-stats-section {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .mini-stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .mini-stats-title {
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mini-stats-title i {
            color: #3498db;
        }

        .mini-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .mini-stats-item {
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .mini-stats-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .item-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }

        .item-value {
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50;
        }

        .item-value.success {
            color: #2ecc71;
        }

        .item-value.warning {
            color: #f39c12;
        }

        .item-value.info {
            color: #3498db;
        }

        /* 右边缩小版的detail1任务状态 */
        .mini-tasks-section {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .mini-tasks-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .mini-tasks-title {
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mini-tasks-title i {
            color: #2ecc71;
        }

        .task-blocks {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .task-block {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .task-block:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .task-block-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #eee;
        }

        .task-block-header h3 {
            font-size: 14px;
            font-weight: 500;
            color: #2c3e50;
        }

        .task-count {
            font-size: 12px;
            color: #666;
            background-color: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .task-number {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
            margin: 10px 0;
        }

        .task-completed {
            color: #2ecc71;
        }

        .task-in-progress {
            color: #3498db;
        }

        .task-waiting {
            color: #f39c12;
        }

        .view-details {
            text-align: center;
            font-size: 12px;
            color: #3498db;
            cursor: pointer;
            padding-top: 5px;
        }
        
        /* 任务列表样式 */
        .mini-task-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            margin-top: 8px;
        }
        
        .mini-task-table thead {
            background-color: #f2f2f2;
        }
        
        .mini-task-table th, 
        .mini-task-table td {
            padding: 4px;
            text-align: left;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .mini-task-table th {
            font-weight: 500;
            color: #666;
        }
        
        .mini-task-table td {
            border-top: 1px solid #eee;
        }
        
        .mini-task-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .mini-asr-btn {
            padding: 2px 4px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 2px;
            font-size: 9px;
            cursor: pointer;
        }
        
        .show-more {
            text-align: center;
            font-size: 11px;
            color: #3498db;
            cursor: pointer;
            padding-top: 6px;
        }

        /* 下方今日进行中的项目 */
        .today-projects-section {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            grid-column: span 2;
        }

        .today-projects-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .today-projects-title {
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .today-projects-title i {
            color: #f39c12;
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }

        .project-card {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .project-card:hover {
            background-color: #fff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* 可跳转的项目卡片 */
        .project-card.clickable {
            cursor: pointer;
            position: relative;
        }
        
        .project-card.clickable:after {
            content: '\f105';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            right: 10px;
            top: 10px;
            color: #3498db;
            font-size: 14px;
            opacity: 0.5;
            transition: all 0.3s ease;
        }
        
        .project-card.clickable:hover:after {
            right: 8px;
            opacity: 1;
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .project-name {
            font-size: 14px;
            font-weight: 500;
            color: #2c3e50;
        }

        .project-calls {
            font-size: 12px;
            color: #666;
            background-color: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .progress-bar {
            height: 8px;
            background-color: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
        }

        .view-all-projects {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px;
            background-color: #f8f9fa;
            border: 1px dashed #ddd;
            border-radius: 8px;
            color: #666;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-all-projects:hover {
            background-color: #eee;
            color: #3498db;
        }
        
        /* 项目状态分类 */
        .project-category {
            margin-bottom: 25px;
        }
        
        .project-category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .project-category-title {
            font-size: 14px;
            font-weight: 500;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .project-category-count {
            font-size: 12px;
            color: #666;
            background-color: #e9ecef;
            padding: 2px 8px;
            border-radius: 12px;
        }
        
        .upcoming .project-category-title i {
            color: #f39c12;
        }
        
        .in-progress .project-category-title i {
            color: #3498db;
        }
        
        .completed .project-category-title i {
            color: #2ecc71;
        }

        /* 折叠菜单样式 */
        .nav-collapse {
            overflow: hidden;
            max-height: 0;
            transition: max-height 0.3s ease;
        }
        
        .nav-collapse.open {
            max-height: 500px; /* 足够大的高度以容纳子菜单 */
        }
        
        .nav-parent {
            position: relative;
        }
        
        .nav-parent:after {
            content: '\f107';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            right: 25px;
            transition: transform 0.3s ease;
        }
        
        .nav-parent.open:after {
            transform: rotate(180deg);
        }
        
        .nav-child {
            padding-left: 55px;
        }
        
        /* AI外呼机器人统计样式 */
        .ai-stats-section {
            background-color: #fff;
            border-radius: 10px;
        }
        
        .ai-stats-section .mini-stats-title i {
            color: #3498db;
        }
        
        .ai-performance-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            position: relative;
        }
        
        .ai-performance-column {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .ai-stats-item {
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .ai-stats-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .ai-stats-row {
            grid-column: span 2;
            margin-top: 8px;
        }
        
        .balance-section {
            background-color: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
        }
        
        .balance-label {
            font-size: 12px;
            color: #666;
        }
        
        .balance-value-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 4px 0;
        }
        
        .balance-value {
            font-size: 16px;
            font-weight: 500;
            color: #f39c12;
        }
        
        .days-remaining {
            font-size: 11px;
            color: #666;
        }
        
        .days-number {
            color: #f39c12;
            font-weight: 500;
        }
        
        .recharge-btn {
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            background-color: #3498db;
            color: white;
            font-size: 11px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: all 0.3s ease;
        }
        
        .recharge-btn:hover {
            background-color: #2980b9;
        }
        
        .recharge-btn i {
            font-size: 10px;
        }
        
        .ai-efficiency-section {
            margin-top: 10px;
            border-top: 1px solid #eee;
            padding-top: 8px;
        }
        
        .efficiency-metrics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }
        
        .efficiency-item {
            text-align: center;
        }
        
        .efficiency-label {
            font-size: 11px;
            color: #666;
            margin-bottom: 2px;
        }
        
        .efficiency-value {
            font-size: 12px;
            font-weight: 500;
            color: #2c3e50;
        }

        /* 图标按钮样式 */
        .icon-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background-color: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 10px;
        }

        .icon-btn:hover {
            background-color: #e9ecef;
        }

        .icon-btn i {
            font-size: 18px;
            color: #666;
        }

        /* AI外呼机器人统计样式 */
        .ai-stats-section {
            background-color: #fff;
            border-radius: 10px;
        }
        
        .ai-stats-section .mini-stats-title i {
            color: #3498db;
        }
        
        .header-recharge-btn {
            padding: 5px 12px;
            font-size: 12px;
            background-color: #3498db;
            border: none;
            border-radius: 4px;
            color: white;
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .header-recharge-btn:hover {
            background-color: #2980b9;
        }
        
        .agent-overview {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .agent-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            overflow: hidden;
        }
        
        .agent-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .agent-info {
            flex: 1;
        }
        
        .agent-header {
            margin-bottom: 5px;
            font-size: 15px;
            font-weight: 500;
            color: #2c3e50;
        }
        
        .agent-recharge-btn {
            padding: 2px 6px;
            font-size: 11px;
            background-color: #f39c12;
            color: white;
            border: none;
            border-radius: 4px;
            display: inline-flex;
            align-items: center;
            gap: 3px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 8px;
            vertical-align: middle;
        }
        
        .agent-recharge-btn:hover {
            background-color: #e67e22;
            transform: translateY(-1px);
        }
        
        .agent-balance {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 5px;
            font-size: 13px;
        }
        
        .balance-label {
            color: #666;
        }
        
        .balance-value {
            font-weight: 500;
            color: #f39c12;
        }
        
        .days-remaining {
            color: #666;
            font-size: 12px;
        }
        
        .days-number {
            color: #f39c12;
            font-weight: 500;
        }
        
        .efficiency-metrics-row {
            display: flex;
            justify-content: space-between;
            margin-top: 12px;
            background-color: #f8f9fa;
            border-radius: 6px;
            padding: 10px;
        }

        /* 项目操作按钮样式 */
        .header-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
        }

        .action-btn i {
            font-size: 12px;
        }

        .create-task-btn {
            background-color: #3498db;
            color: white;
        }

        .create-task-btn:hover {
            background-color: #2980b9;
        }

        .change-strategy-btn {
            background-color: #f8f9fa;
            color: #666;
            border: 1px solid #ddd;
        }

        .change-strategy-btn:hover {
            background-color: #e9ecef;
            color: #333;
        }

        /* 弹窗样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 9999;
        }

        .modal.show {
            display: block;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(2px);
        }

        .modal-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff !important;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
            width: 90%;
            max-width: 1200px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            z-index: 10000;
            overflow: hidden;
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fff !important;
            border-radius: 12px 12px 0 0;
        }

        .modal-header h2 {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
        }

        .modal-content {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            background: #f8f9fa !important;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            max-height: 70vh;
        }

        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            background: #fff !important;
            border-radius: 0 0 12px 12px;
        }

        .task-section {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            margin-bottom: 0;
        }

        .task-section.full-width {
            grid-column: span 2;
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 16px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title i {
            color: #3498db;
            font-size: 18px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #555;
            margin-bottom: 8px;
        }

        .cancel-btn, .submit-btn {
            padding: 10px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .cancel-btn {
            background-color: #f1f5f9;
            color: #64748b;
        }

        .cancel-btn:hover {
            background-color: #e2e8f0;
        }

        .submit-btn {
            background-color: #3498db;
            color: white;
        }

        .submit-btn:hover {
            background-color: #2980b9;
        }

        .submit-btn i {
            font-size: 14px;
        }

        /* 占位符消息样式 */
        .placeholder-message {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .placeholder-message i {
            font-size: 48px;
            margin-bottom: 20px;
            color: #3498db;
        }

        .placeholder-message p {
            font-size: 16px;
            margin: 0;
        }

        /* 文本域样式 */
        textarea {
            width: 100%;
            min-height: 100px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            resize: vertical;
        }

        /* 快捷键弹窗样式 */
        .shortcuts-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 20px;
        }

        .shortcut-item {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 6px;
        }

        .shortcut-item .key {
            background-color: #fff;
            padding: 5px 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
            font-family: monospace;
            font-size: 14px;
            color: #333;
            min-width: 100px;
            text-align: center;
        }

        .shortcut-item .description {
            color: #666;
            font-size: 14px;
        }

        /* 标签输入弹窗样式 */
        .tag-input-modal {
            position: absolute;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 10px;
            z-index: 1100;
        }

        .tag-input-container {
            display: flex;
            gap: 10px;
        }

        .tag-input-container input {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .tag-input-container button {
            padding: 6px 12px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .tag-input-container button:hover {
            background-color: #2980b9;
        }

        /* 时间网格生成的样式补充 */
        .time-grid {
            border: 1px solid #eee;
            border-radius: 4px;
            overflow: hidden;
        }

        .time-grid-header {
            display: grid;
            grid-template-columns: 60px repeat(7, 1fr);
            background-color: #f8f9fa;
            border-bottom: 1px solid #eee;
        }

        .time-cell {
            padding: 8px;
            text-align: center;
            font-size: 12px;
            color: #666;
            border-right: 1px solid #eee;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .time-cell:hover:not(:first-child) {
            background-color: rgba(52, 152, 219, 0.1);
        }

        .time-cell.active {
            background-color: #e1f0ff;
            color: #3498db;
        }

        .time-row {
            display: grid;
            grid-template-columns: 60px repeat(7, 1fr);
        }

        .time-cell:first-child {
            background-color: #f8f9fa;
            font-weight: 500;
            cursor: default;
        }

        /* 黑名单管理弹窗样式 */
        .blacklist-modal .modal-content {
            padding: 0;
        }

        .blacklist-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
        }

        .blacklist-filters {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .blacklist-search {
            flex: 1;
            position: relative;
        }

        .blacklist-search input {
            width: 100%;
            padding: 8px 12px;
            padding-left: 35px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .blacklist-search i {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        .blacklist-table {
            width: 100%;
            border-collapse: collapse;
        }

        .blacklist-table th,
        .blacklist-table td {
            padding: 12px 20px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .blacklist-table th {
            background-color: #f8f9fa;
            font-weight: 500;
            color: #666;
        }

        .blacklist-table tr:hover {
            background-color: #f8f9fa;
        }

        .blacklist-actions {
            display: flex;
            gap: 10px;
        }

        .blacklist-actions button {
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .edit-btn {
            background-color: #f8f9fa;
            color: #666;
            border: 1px solid #ddd;
        }

        .delete-btn {
            background-color: #fff5f5;
            color: #e74c3c;
            border: 1px solid #ffd5d5;
        }

        .edit-btn:hover {
            background-color: #e9ecef;
            color: #333;
        }

        .delete-btn:hover {
            background-color: #fee2e2;
            color: #c0392b;
        }

        /* 导入黑名单弹窗样式 */
        .import-modal .modal-content {
            padding: 20px;
        }

        .import-steps {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .import-step {
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #eee;
        }

        .import-step-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .step-number {
            width: 24px;
            height: 24px;
            background-color: #3498db;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 500;
        }

        .step-title {
            font-size: 14px;
            font-weight: 500;
            color: #2c3e50;
        }

        .import-dropzone {
            border: 2px dashed #ddd;
            border-radius: 6px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .import-dropzone:hover {
            border-color: #3498db;
            background-color: rgba(52, 152, 219, 0.05);
        }

        .import-dropzone i {
            font-size: 32px;
            color: #3498db;
            margin-bottom: 10px;
        }

        .import-dropzone p {
            margin: 0;
            color: #666;
            font-size: 14px;
        }

        .import-template {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #eee;
            border-radius: 4px;
        }

        .template-icon {
            color: #3498db;
        }

        .template-info {
            flex: 1;
        }

        .template-name {
            font-size: 14px;
            color: #2c3e50;
            margin-bottom: 2px;
        }

        .template-size {
            font-size: 12px;
            color: #666;
        }

        .download-template {
            padding: 6px 12px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .download-template:hover {
            background-color: #e9ecef;
            color: #333;
        }

        .strategy-time-cell:first-child {
            background-color: #f8f9fa;
            font-weight: 500;
            cursor: default;
        }
        
        .priority-badge {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            color: white;
        }
        
        .priority-badge.p0 { background: #e74c3c; }
        .priority-badge.p1 { background: #f39c12; }
        .priority-badge.p2 { background: #3498db; }
        .priority-badge.p3 { background: #95a5a6; }
        
        .priority-info {
            flex: 1;
        }
        
        .priority-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .priority-desc {
            font-size: 12px;
            color: #7f8c8d;
        }
        
        /* 身份策略样式 */
        .identity-settings {
            display: grid;
            gap: 20px;
        }
        
        .setting-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .setting-group label {
            min-width: 100px;
            color: #2c3e50;
        }
        
        .identity-select {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            background: white;
        }
        
        .toggle-group {
            display: flex;
            gap: 10px;
        }
        
        .toggle-btn {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .toggle-btn:hover {
            background: #f5f7fa;
        }
        
        .toggle-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        
        /* 方言标签样式 */
        .dialect-options {
            margin-top: 15px;
        }
        
        .dialect-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .dialect-tag {
            display: inline-flex;
            align-items: center;
            padding: 5px 10px;
            background: #e1f0fa;
            border-radius: 15px;
            font-size: 12px;
            color: #2c3e50;
        }
        
        .dialect-tag i {
            margin-left: 8px;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .dialect-tag i:hover {
            color: #e74c3c;
        }
        
        .add-dialect-btn {
            padding: 5px 10px;
            background: none;
            border: 1px dashed #3498db;
            border-radius: 15px;
            color: #3498db;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .add-dialect-btn:hover {
            background: #f7f9fc;
        }
        
        .add-dialect-btn i {
            margin-right: 5px;
        }
        
        /* 知识库和RPA设置样式 */
        .knowledge-base,
        .rpa-flow {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .knowledge-base:last-child,
        .rpa-flow:last-child {
            border-bottom: none;
        }
        
        .base-name,
        .flow-name {
            font-weight: 500;
        }
        
        .flow-trigger {
            font-size: 12px;
            color: #7f8c8d;
        }
        
        /* 开关样式 */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #3498db;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        /* 标签输入弹窗样式 */
        .tag-input-modal {
            position: absolute;
            z-index: 1000;
            background: white;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            padding: 10px;
        }
        
        .tag-input-container {
            display: flex;
            gap: 10px;
        }
        
        .tag-input-container input {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            outline: none;
        }
        
        .tag-input-container input:focus {
            border-color: #3498db;
        }
        
        .tag-input-container button {
            padding: 6px 12px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .tag-input-container button:hover {
            background: #2980b9;
        }

        /* 新的策略弹窗样式 */
        .draggable-tasks-section {
            background: #fff !important;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .task-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .task-card {
            background: #f8f9fa !important;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            cursor: move;
            transition: all 0.3s ease;
            position: relative;
        }

        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .task-card.dragging {
            opacity: 0.5;
            background: #fff;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .task-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .task-name {
            font-size: 14px;
            font-weight: 500;
            color: #2c3e50;
        }

        .task-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
        }

        .task-status.running {
            background: #e1f0ff;
            color: #3498db;
        }

        .task-status.pending {
            background: #fff7e6;
            color: #f39c12;
        }

        .task-status.completed {
            background: #e8f5e9;
            color: #2ecc71;
        }

        .task-progress {
            margin-top: 10px;
        }

        .progress-bar {
            height: 6px;
            background: #eee;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #3498db;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .task-info {
            margin-top: 10px;
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #666;
        }

        .strategy-settings-section {
            background: #fff !important;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .strategy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .strategy-item {
            background: #f8f9fa !important;
            border-radius: 8px;
            padding: 15px;
        }

        .strategy-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .strategy-item-header h4 {
            margin: 0;
            color: #2c3e50;
            font-size: 14px;
            font-weight: 500;
        }

        .strategy-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .strategy-btn {
            background: #fff !important;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 6px 12px;
            font-size: 13px;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .strategy-btn.active {
            background: #3498db !important;
            color: #fff;
            border-color: #3498db;
        }

        .strategy-btn:hover {
            background: #f1f1f1;
        }

        .strategy-btn.active:hover {
            background: #2980b9;
        }

        .strategy-value {
            font-size: 14px;
            font-weight: 500;
            color: #2c3e50;
        }

        .strategy-modal-large {
            width: 90%;
            max-width: 1200px;
            height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .strategy-modal-large .modal-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .input-with-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .input-with-actions input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .input-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn-small {
            padding: 6px 12px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn-small:hover {
            background-color: #e9ecef;
            color: #333;
        }

        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .tag {
            padding: 4px 8px;
            background-color: #e1f0ff;
            color: #3498db;
            border-radius: 4px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tag i {
            cursor: pointer;
            font-size: 10px;
        }

        .tag i:hover {
            color: #2980b9;
        }

        .add-tag-btn {
            padding: 4px 8px;
            background-color: #f8f9fa;
            border: 1px dashed #ddd;
            border-radius: 4px;
            font-size: 12px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-tag-btn:hover {
            background-color: #e9ecef;
            color: #333;
        }

        .toggle-switch {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toggle-switch input[type="checkbox"] {
            display: none;
        }

        .toggle-switch label {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
            background-color: #ddd;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 0;
        }

        .toggle-switch label:after {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: white;
            top: 2px;
            left: 2px;
            transition: all 0.3s ease;
        }

        .toggle-switch input[type="checkbox"]:checked + label {
            background-color: #3498db;
        }

        .toggle-switch input[type="checkbox"]:checked + label:after {
            transform: translateX(20px);
        }

        .duration-selection {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .duration-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .duration-btn {
            padding: 6px 12px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .duration-btn.active {
            background-color: #3498db;
            color: white;
            border-color: #3498db;
        }

        .custom-duration {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .custom-duration input {
            width: 80px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
        }

        .script-selection {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .script-selection select {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .preview-btn,
        .edit-btn {
            padding: 6px 12px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .preview-btn:hover,
        .edit-btn:hover {
            background-color: #e9ecef;
            color: #333;
        }

        .line-selection {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .line-selection select {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .line-selection input {
            width: 100px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .blacklist-setting {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .blacklist-btn,
        .import-btn {
            padding: 6px 12px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .blacklist-btn:hover,
        .import-btn:hover {
            background-color: #e9ecef;
            color: #333;
        }

        .time-range {
            display: flex;
            gap: 20px;
        }

        .time-input {
            flex: 1;
        }

        .time-input input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            background-color: #f8f9fa;
        }

        .time-grid {
            border: 1px solid #eee;
            border-radius: 4px;
            overflow: hidden;
        }

        .time-grid-header {
            display: grid;
            grid-template-columns: 60px repeat(7, 1fr);
            background-color: #f8f9fa;
            border-bottom: 1px solid #eee;
        }

        .time-cell {
            padding: 8px;
            text-align: center;
            font-size: 12px;
            color: #666;
            border-right: 1px solid #eee;
            border-bottom: 1px solid #eee;
        }

        .time-row {
            display: grid;
            grid-template-columns: 60px repeat(7, 1fr);
        }

        .time-cell.active {
            background-color: #e1f0ff;
            color: #3498db;
        }

        .interval-selection {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .interval-btn {
            padding: 6px 12px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .interval-btn.active {
            background-color: #3498db;
            color: white;
            border-color: #3498db;
        }

        .custom-interval {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .custom-interval input {
            width: 80px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
        }

        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            resize: vertical;
            min-height: 80px;
        }

        /* 线索导入卡片样式 */
        .leads-import-container {
            display: flex;
            gap: 20px;
            width: 100%;
        }

        .import-card {
            flex: 1;
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            border: 1px solid #eee;
        }

        .import-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            border-color: #3498db;
        }

        .import-card-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: linear-gradient(135deg, #e1f0ff, #c8e6ff);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        .import-card-icon i {
            font-size: 24px;
            color: #3498db;
        }

        .import-card-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .import-card-desc {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .import-card-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .import-card-stats .stat-item {
            display: flex;
            flex-direction: column;
        }

        .import-card-stats .stat-value {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .import-card-stats .stat-label {
            font-size: 12px;
            color: #7f8c8d;
        }

        .import-card-upload {
            background-color: #f8f9fa;
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .import-card-upload:hover {
            background-color: #e1f0ff;
            border-color: #3498db;
        }

        .import-card-upload i {
            font-size: 24px;
            color: #3498db;
            margin-bottom: 10px;
            display: block;
        }

        .import-card-upload span {
            display: block;
            font-size: 14px;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .import-card-upload small {
            display: block;
            font-size: 12px;
            color: #7f8c8d;
        }

        .import-card-btn {
            margin-top: auto;
            padding: 10px;
            border-radius: 8px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            color: #2c3e50;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .import-card-btn:hover {
            background-color: #3498db;
            color: white;
            border-color: #3498db;
        }

        .import-card-btn i {
            font-size: 14px;
        }

        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            resize: vertical;
            min-height: 80px;
        }

        /* 新增样式 - 身份与策略模块 */
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .half-width {
            flex: 1;
            min-width: 0;
        }
        
        .priority-selection {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }
        
        .priority-option-btn {
            padding: 6px 12px;
            border: 1px solid #ddd;
            background: #f5f5f5;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .priority-option-btn.active {
            background: #1890ff;
            color: white;
            border-color: #1890ff;
        }
        
        .priority-desc {
            margin-left: 10px;
            color: #666;
            font-size: 13px;
        }
        
        .select-with-toggle {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .select-with-toggle select {
            flex: 1;
        }
        
        .toggle-switch.small {
            transform: scale(0.8);
            margin-right: -10px;
        }
        
        .toggle-switch.small + span {
            font-size: 13px;
            color: #666;
        }
        
        .script-selection {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .script-selection select {
            flex: 1;
        }
        
        .preview-btn, .edit-btn {
            padding: 6px 12px;
            border: 1px solid #ddd;
            background: #f8f8f8;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 13px;
        }
        
        .preview-btn:hover, .edit-btn:hover {
            background: #f0f0f0;
        }
        
        .edit-btn {
            color: #1890ff;
            border-color: #1890ff;
            background: rgba(24, 144, 255, 0.1);
        }

        /* 新建任务弹窗样式优化 - 更紧凑的布局 */
        .modal-container {
            max-width: 1000px; /* 减小弹窗宽度 */
        }

        .modal-content {
            padding: 16px; /* 减小内边距 */
            gap: 16px; /* 减小卡片间距 */
        }

        .task-section {
            padding: 16px; /* 减小卡片内边距 */
        }

        .section-title {
            margin-bottom: 12px; /* 减小标题下方间距 */
            padding-bottom: 8px; /* 减小标题下边框间距 */
        }

        .form-group {
            margin-bottom: 12px; /* 减小表单组间距 */
        }

        .form-group label {
            margin-bottom: 4px; /* 减小标签下方间距 */
        }

        .form-row {
            gap: 12px; /* 减小行内元素间距 */
            margin-bottom: 12px; /* 减小行间距 */
        }

        /* 优先级和项目进行时间样式优化 */
        .priority-selection {
            gap: 6px; /* 减小按钮间距 */
        }

        .priority-option-btn {
            padding: 4px 10px; /* 减小按钮内边距 */
        }

        .duration-options {
            gap: 6px; /* 减小按钮间距 */
        }

        .duration-btn {
            padding: 4px 10px; /* 减小按钮内边距 */
        }

        /* 添加下载链接样式 */
        .download-template-link {
            display: block;
            margin-top: 10px;
            color: #3498db;
            text-decoration: none;
            font-size: 13px;
            transition: all 0.3s ease;
        }

        .download-template-link:hover {
            color: #2980b9;
            text-decoration: underline;
        }

        .download-template-link i {
            margin-right: 5px;
        }

        /* 项目列表样式 */
        .project-list {
            margin-top: 15px;
        }

        .project-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .project-table th,
        .project-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .project-table th {
            background-color: #f8f9fa;
            font-weight: 500;
            color: #666;
            font-size: 13px;
        }

        .project-table tr:hover {
            background-color: #f8f9fa;
        }

        .project-table td {
            font-size: 14px;
            color: #2c3e50;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-badge.pending {
            background-color: #fff7e6;
            color: #f39c12;
        }

        .status-badge.running {
            background-color: #e1f0ff;
            color: #3498db;
        }

        .status-badge.completed {
            background-color: #e8f5e9;
            color: #2ecc71;
        }

        .action-btn-small {
            padding: 4px 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            color: #666;
            font-size: 12px;
            cursor: pointer;
            margin-right: 5px;
            transition: all 0.3s ease;
        }

        .action-btn-small:hover {
            background: #f8f9fa;
            border-color: #3498db;
            color: #3498db;
        }

        .action-btn-small i {
            margin-right: 4px;
        }

        /* 项目类别样式优化 */
        .project-category {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .project-category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .project-category-title {
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .project-category-title i {
            font-size: 18px;
        }

        .project-category-count {
            background: #f8f9fa;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 13px;
            color: #666;
        }

        /* 状态图标颜色 */
        .upcoming .project-category-title i {
            color: #f39c12;
        }

        .in-progress .project-category-title i {
            color: #3498db;
        }

        .completed .project-category-title i {
            color: #2ecc71;
        }

        /* 任务块样式优化 */
        .task-blocks {
            padding: 15px;
        }

        .task-block {
            background: #fff;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 15px;
        }

        .task-block-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .task-block-header h3 {
            font-size: 14px;
            font-weight: 500;
            color: #2c3e50;
            margin: 0;
        }

        .task-count {
            font-size: 12px;
            color: #666;
            background: #f8f9fa;
            padding: 2px 8px;
            border-radius: 12px;
        }

        .mini-task-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        .mini-task-table th,
        .mini-task-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .mini-task-table th {
            background: #f8f9fa;
            font-weight: 500;
            color: #666;
        }

        .show-more {
            text-align: center;
            padding-top: 10px;
            font-size: 12px;
        }

        .show-more a:hover {
            text-decoration: underline !important;
        }

        /* 筛选栏按钮悬停效果 */
        .filter-btn:hover {
            background: #f8f9fa;
            border-color: #ddd;
        }

        .filter-btn.active:hover {
            background: #2980b9;
            border-color: #2980b9;
        }

        .action-btn:hover {
            opacity: 0.9;
        }

        /* 调整主容器上边距，为筛选栏留出空间 */
        .main-container {
            margin-left: 240px;
            padding: 190px 24px 24px;
            max-width: 1400px;
        }

        .stat-card {
            position: relative;
            overflow: hidden;
        }

        .stat-card.clickable:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .stat-card.clickable::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card.clickable:hover::after {
            opacity: 1;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: none;
        }

        .modal.show {
            display: block;
        }

        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }

        .modal-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 18px;
            color: #2c3e50;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .modal-content {
            padding: 20px;
            overflow-y: auto;
            max-height: calc(90vh - 70px);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-10px); }
        }

        .recharge-btn {
            transition: all 0.2s ease;
        }

        .yang-section, .yin-section {
            transition: all 0.3s ease;
        }

        .yang-section:hover {
            transform: translateX(5px);
        }

        .yin-section:hover {
            transform: translateX(-5px);
        }

        .action-btn-small i {
            margin-right: 4px;
        }

        /* 新增横向操作按钮样式 */
        .operation-buttons {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 8px;
        }

        .operation-buttons .action-btn-small {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            padding: 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            color: #666;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .operation-buttons .action-btn-small:hover {
            background: #f8f9fa;
            border-color: #3498db;
            color: #3498db;
            transform: translateY(-1px);
        }

        .operation-buttons .action-btn-small i {
            margin: 0;
        }

        .project-table td {
            font-size: 14px;
            color: #2c3e50;
            padding: 12px 15px;
            vertical-align: middle;
        }

        .project-table th {
            padding: 12px 15px;
            text-align: left;
            background-color: #f8f9fa;
            font-weight: 500;
            color: #666;
            font-size: 13px;
            vertical-align: middle;
        }

        /* 在.project-table th样式后添加新的CSS规则 */
        .project-table th {
            padding: 12px 15px;
            text-align: left;
            background-color: #f8f9fa;
            font-weight: 500;
            color: #666;
            font-size: 13px;
            vertical-align: middle;
        }

        /* 修改操作列标题对齐 */
        .project-table th:last-child,
        table th:last-child {
            text-align: center;
            padding-right: 30px;
        }

        .operation-buttons {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        /* 修改操作列标题对齐 - 增加选择器优先级 */
        .project-table th:last-child,
        .main-container table th:last-child {
            text-align: center !important;
            padding-right: 30px;
        }

        .project-table .operation-buttons,
        .main-container table .operation-buttons {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        /* 当前进行中任务的操作按钮对齐 */
        .main-container > div:first-of-type table .operation-buttons {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding-right: 15px;  /* 调整右边距使图标对齐 */
        }

        /* 保持原有的其他表格样式不变 */
        .project-table th:last-child {
            text-align: center;
            padding-right: 30px;
        }

        .project-table .operation-buttons {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        /* 添加导出报告弹窗样式 */
        .export-options-popup {
            position: absolute;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
            padding: 10px;
            z-index: 1000;
            display: none;
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .export-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .export-option:hover {
            background: #f5f7fa;
        }

        .export-option i {
            font-size: 16px;
            width: 20px;
            text-align: center;
            color: #3498db;
        }

        .export-option-label {
            font-size: 14px;
            color: #2c3e50;
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 999;
            display: none;
        }
    </style>
</head>
<body>
    <!-- 顶部导航栏 -->
    <header class="header">
        <div class="logo">
            <img src="AION LOGO.png" alt="AION Logo">
            <h1>小美工作台</h1>
        </div>
        <div class="header-right">
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="搜索任务、客户或记录...">
            </div>
            <div class="user-info">
                <i class="fas fa-user-circle"></i>
            </div>
        </div>
    </header>

    <!-- 面包屑导航 -->
    <div class="breadcrumb">
        <a href="index.html">
            <i class="fas fa-home"></i>
            员工中心
        </a>
        <i class="fas fa-chevron-right"></i>
        <span>小美工作台</span>
    </div>

    <nav class="side-nav">
        <div class="nav-group">
            <a href="index.html" class="nav-item">
                <i class="fas fa-home"></i>
                <span>员工中心</span>
            </a>
        </div>
        
        <div class="nav-group">
            <div class="nav-section-title">工作台切换</div>
            <a href="xiaomei_today_tasks.html" class="nav-item active">
                <i class="fas fa-user"></i>
                <span>小美工作台</span>
            </a>
            <a href="customer_service.html" class="nav-item">
                <i class="fas fa-user-tie"></i>
                <span>小明工作台</span>
            </a>
        </div>

        <div class="nav-group">
            <div class="nav-section-title">客户管理系统</div>
            <a href="crm.html" class="nav-item">
                <i class="fas fa-users"></i>
                <span>客户管理</span>
            </a>
        </div>
    </nav>

    <!-- 主内容区域 -->
    <main class="main-container">
        <!-- 上方卡片区域 -->
        <div style="margin-bottom: 20px;">
            <!-- 小美信息区域整合到卡片顶部 -->
            <div class="agent-overview" style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px; padding: 15px; background: #fff; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                <div class="agent-avatar" style="width: 50px; height: 50px;">
                    <img src="李小红.png" alt="小美" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                </div>
                <div style="flex: 1;">
                    <div style="display: flex; justify-content: flex-start; align-items: center; gap: 10px;">
                        <div>
                            <div style="font-size: 12px; font-style: italic; color: #666; margin-bottom: 2px;">外呼专员</div>
                            <div style="font-size: 16px; font-weight: 500; display: flex; align-items: center; gap: 10px;">
                                小美
                                <button class="recharge-btn agent-recharge-btn" style="padding: 4px 10px; font-size: 12px; background: linear-gradient(45deg, #FF9500, #FF5E3A); color: white; border: none; border-radius: 4px; cursor: pointer; display: flex; align-items: center; gap: 4px; box-shadow: 0 2px 4px rgba(255, 94, 58, 0.3);">
                                            <i class="fas fa-bolt"></i>
                                            任务中
                                        </button>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px; margin-top: 4px;">
                        <div style="font-size: 13px; color: #666;">
                            <span style="color: #2ecc71;">2025-03-16-0:00</span>
                            至
                            <span style="color: #2ecc71;">2025-03-16-10:09</span>
                            ，小美已经完成了您布置的
                            <span style="color: #2ecc71;">3</span>
                            个任务，共为您拨打了
                            <span style="color: #2ecc71;">20000</span>
                            通电话，预计将在
                            <span style="color: #2ecc71;">2025-03-16-18:00</span>
                            完成您布置的全部任务
                        </div>
                    </div>
                </div>
            </div>

            <!-- 统一的工作报告和任务列表卡片 -->
            <div style="background: #fff; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                <!-- 工作报告部分 -->
                <div style="margin-bottom: 20px;">
                    <!-- 工作报告标题和时间选择器 -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-file-alt" style="color: #3498db; font-size: 20px;"></i>
                            <span style="font-size: 16px; font-weight: 500; color: #2c3e50;">工作报告</span>
                        </div>

                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="display: flex; gap: 5px;">
                                <button class="filter-btn" style="padding: 6px 12px; border: 1px solid #e9ecef; background: #fff; border-radius: 4px; color: #666; font-size: 13px; cursor: pointer; transition: all 0.3s ease;">昨日</button>
                                <button class="filter-btn" style="padding: 6px 12px; border: 1px solid #2ecc71; background: rgba(46, 204, 113, 0.1); border-radius: 4px; color: #2ecc71; font-size: 13px; cursor: pointer; transition: all 0.3s ease;">今日</button>
                                <button class="filter-btn" style="padding: 6px 12px; border: 1px solid #e9ecef; background: #fff; border-radius: 4px; color: #666; font-size: 13px; cursor: pointer; transition: all 0.3s ease;">七日</button>
                                <button class="filter-btn" style="padding: 6px 12px; border: 1px solid #e9ecef; background: #fff; border-radius: 4px; color: #666; font-size: 13px; cursor: pointer; transition: all 0.3s ease;">十四日</button>
                                <button class="filter-btn" style="padding: 6px 12px; border: 1px solid #e9ecef; background: #fff; border-radius: 4px; color: #666; font-size: 13px; cursor: pointer; transition: all 0.3s ease;">月</button>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <input type="date" value="2025-03-16" style="padding: 6px 12px; border: 1px solid #e9ecef; background: #fff; border-radius: 4px; color: #666; font-size: 13px; cursor: pointer; transition: all 0.3s ease;">
                                <span style="color: #666;">至</span>
                                <input type="date" value="2025-03-16" style="padding: 6px 12px; border: 1px solid #e9ecef; background: #fff; border-radius: 4px; color: #666; font-size: 13px; cursor: pointer; transition: all 0.3s ease;">
                            </div>
                            <button id="exportReportBtn" class="export-btn" style="padding: 6px 16px; border: 1px solid #2ecc71; background: rgba(46, 204, 113, 0.1); border-radius: 4px; color: #2ecc71; font-size: 13px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 5px; white-space: nowrap; position: relative;">
                                <i class="fas fa-file-export"></i>
                                导出报告
                            </button>
                        </div>
                    </div>

                    <!-- 添加导出报告弹窗 -->
                    <div id="exportOptionsPopup" class="export-options-popup">
                        <div class="export-option" onclick="exportReport('excel')">
                            <i class="fas fa-file-excel"></i>
                            <span class="export-option-label">Excel表格导出</span>
                        </div>
                        <div class="export-option" onclick="exportReport('pdf')">
                            <i class="fas fa-file-pdf"></i>
                            <span class="export-option-label">PDF文档导出</span>
                        </div>
                        <div class="export-option" onclick="exportReport('csv')">
                            <i class="fas fa-file-csv"></i>
                            <span class="export-option-label">CSV格式导出</span>
                        </div>
                        <div class="export-option" onclick="exportReport('print')">
                            <i class="fas fa-print"></i>
                            <span class="export-option-label">打印报告</span>
                        </div>
                    </div>
                    
                    <div id="popupOverlay" class="popup-overlay"></div>

                    <!-- 统计数据卡片 -->
                    <div style="display: flex; gap: 15px; justify-content: space-between; flex-wrap: wrap; margin-bottom: 20px;">
                        <div style="flex: 1; background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 3px solid #2ecc71; cursor: pointer;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 8px;">已完成任务</div>
                            <div style="font-size: 20px; font-weight: 600; color: #2ecc71;">10个</div>
                        </div>
                        
                        <div style="flex: 1; background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 3px solid #3498db; cursor: pointer;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 8px;">拨打电话</div>
                            <div style="font-size: 20px; font-weight: 600; color: #3498db;">60000通</div>
                        </div>
                        
                        <div style="flex: 1; background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 3px solid #f39c12; cursor: pointer;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 8px;">接通数</div>
                            <div style="font-size: 20px; font-weight: 600; color: #f39c12;">21000通</div>
                        </div>

                        <div style="flex: 1; background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 3px solid #9b59b6; cursor: pointer;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 8px;">产出</div>
                            <div style="font-size: 20px; font-weight: 600; color: #9b59b6;">10000</div>
                        </div>

                        <div style="flex: 1; background: #f8f9fa; padding: 12px; border-radius: 6px; border-left: 3px solid #e74c3c; cursor: pointer;">
                            <div style="font-size: 12px; color: #666; margin-bottom: 8px;">消耗</div>
                            <div style="font-size: 20px; font-weight: 600; color: #e74c3c;">¥10000</div>
                        </div>
                    </div>
                </div>

                <!-- 期间任务部分 -->
                <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-play-circle" style="color: #3498db; font-size: 16px;"></i>
                            <span style="font-size: 14px; font-weight: 500; color: #2c3e50;">期间任务</span>
                        </div>
                    </div>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="padding: 12px; text-align: left; font-weight: 500; color: #666; border-bottom: 1px solid #eee; width: 25%;">任务名称</th>
                                <th style="padding: 12px; text-align: left; font-weight: 500; color: #666; border-bottom: 1px solid #eee; width: 20%;">任务数</th>
                                <th style="padding: 12px; text-align: left; font-weight: 500; color: #666; border-bottom: 1px solid #eee; width: 20%;">任务状态</th>
                                <th style="padding: 12px; text-align: left; font-weight: 500; color: #666; border-bottom: 1px solid #eee; width: 25%;">进度</th>
                                <th style="padding: 12px; text-align: right; font-weight: 500; color: #666; border-bottom: 1px solid #eee; width: 10%;">操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid #eee;">19.9大促销</td>
                                <td style="padding: 12px; border-bottom: 1px solid #eee;">2,500</td>
                                <td style="padding: 12px; border-bottom: 1px solid #eee;">
                                    <span style="padding: 4px 8px; background-color: #e8f5e9; color: #2ecc71; border-radius: 4px; font-size: 12px;">进行中</span>
                                </td>
                                <td style="padding: 12px; border-bottom: 1px solid #eee;">
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <div style="flex: 1; height: 6px; background: #eee; border-radius: 3px;">
                                            <div style="width: 70%; height: 100%; background: #3498db; border-radius: 3px;"></div>
                                        </div>
                                        <span style="font-size: 12px; color: #666;">70%</span>
                                    </div>
                                </td>
                                <td style="padding: 12px; border-bottom: 1px solid #eee;">
                                    <div style="display: flex; align-items: center; gap: 10px; justify-content: flex-end;">
                                        <button class="action-btn-small" style="color: #e74c3c;"><i class="fas fa-pause"></i></button>
                                        <a href="detail_running.html" class="action-btn-small"><i class="fas fa-eye"></i></a>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid #eee;">29.9特惠</td>
                                <td style="padding: 12px; border-bottom: 1px solid #eee;">1,800</td>
                                <td style="padding: 12px; border-bottom: 1px solid #eee;">
                                    <span style="padding: 4px 8px; background-color: #e8f5e9; color: #2ecc71; border-radius: 4px; font-size: 12px;">进行中</span>
                                </td>
                                <td style="padding: 12px; border-bottom: 1px solid #eee;">
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <div style="flex: 1; height: 6px; background: #eee; border-radius: 3px;">
                                            <div style="width: 45%; height: 100%; background: #3498db; border-radius: 3px;"></div>
                                        </div>
                                        <span style="font-size: 12px; color: #666;">45%</span>
                                    </div>
                                </td>
                                <td style="padding: 12px; border-bottom: 1px solid #eee;">
                                    <div style="display: flex; align-items: center; gap: 10px; justify-content: flex-end;">
                                        <button class="action-btn-small" style="color: #e74c3c;"><i class="fas fa-pause"></i></button>
                                        <a href="detail_running.html" class="action-btn-small"><i class="fas fa-eye"></i></a>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 全任务概览部分 -->
        <section class="today-projects-section">
            <div class="today-projects-header">
                <div class="today-projects-title">
                    <i class="fas fa-project-diagram"></i>
                    全任务概览
                </div>
                <div class="header-actions">
                    <button class="action-btn create-task-btn" onclick="window.open('create_task.html', '_blank', 'width=900,height=800')">
                        <i class="fas fa-plus"></i>
                        新建任务
                    </button>
                </div>
            </div>
            
            <!-- 原有的任务列表内容 -->
            <div class="project-list">
                <table class="project-table">
                    <thead>
                        <tr>
                            <th>任务名称</th>
                            <th>总通数</th>
                            <th>开始时间</th>
                            <th>状态</th>
                            <th>预计结束时间</th>
                            <th>完成时间</th>
                            <th>剩余时间</th>
                            <th>转化率</th>
                            <th>进度</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 将要进行的任务 -->
                        <tr>
                            <td>双12特惠</td>
                            <td>5,200通</td>
                            <td>2025-12-10</td>
                            <td><span class="status-badge pending">待开始</span></td>
                            <td>2025-12-13 18:00</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>
                                <div class="progress-bar" style="width: 100%; height: 6px; background: #eee; border-radius: 3px;">
                                    <div class="progress-fill" style="width: 0%; height: 100%; background: #3498db; border-radius: 3px;"></div>
                                </div>
                            </td>
                            <td>
                                <div class="operation-buttons">
                                    <button class="action-btn-small" title="开始任务"><i class="fas fa-play"></i></button>
                                    <button class="action-btn-small" title="变更策略"><i class="fas fa-cog"></i></button>
                                    <a href="detail_upcoming.html" class="action-btn-small" title="查看详情"><i class="fas fa-eye"></i></a>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>春节促销预热</td>
                            <td>8,000通</td>
                            <td>2026-01-15</td>
                            <td><span class="status-badge pending">待开始</span></td>
                            <td>2026-01-20 18:00</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>
                                <div class="progress-bar" style="width: 100%; height: 6px; background: #eee; border-radius: 3px;">
                                    <div class="progress-fill" style="width: 0%; height: 100%; background: #3498db; border-radius: 3px;"></div>
                                </div>
                            </td>
                            <td>
                                <div class="operation-buttons">
                                    <button class="action-btn-small" title="开始任务"><i class="fas fa-play"></i></button>
                                    <button class="action-btn-small" title="变更策略"><i class="fas fa-cog"></i></button>
                                    <a href="detail_upcoming.html" class="action-btn-small" title="查看详情"><i class="fas fa-eye"></i></a>
                                </div>
                            </td>
                        </tr>

                        <!-- 正在进行的任务 -->
                        <tr>
                            <td>19.9大促销</td>
                            <td>3,500通</td>
                            <td>2025-12-05</td>
                            <td><span class="status-badge running">进行中</span></td>
                            <td>2025-12-08 18:00</td>
                            <td>-</td>
                            <td>2小时</td>
                            <td>32%</td>
                            <td>
                                <div class="progress-bar" style="width: 100%; height: 6px; background: #eee; border-radius: 3px;">
                                    <div class="progress-fill" style="width: 70%; height: 100%; background: #3498db; border-radius: 3px;"></div>
                                </div>
                            </td>
                            <td>
                                <div class="operation-buttons">
                                    <button class="action-btn-small" style="color: #e74c3c;" title="暂停任务"><i class="fas fa-pause"></i></button>
                                    <button class="action-btn-small" title="变更策略"><i class="fas fa-cog"></i></button>
                                    <a href="detail_running.html" class="action-btn-small" title="查看详情"><i class="fas fa-eye"></i></a>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>29.9特惠</td>
                            <td>2,800通</td>
                            <td>2025-12-05</td>
                            <td><span class="status-badge running">进行中</span></td>
                            <td>2025-12-07 18:00</td>
                            <td>-</td>
                            <td>3小时</td>
                            <td>28%</td>
                            <td>
                                <div class="progress-bar" style="width: 100%; height: 6px; background: #eee; border-radius: 3px;">
                                    <div class="progress-fill" style="width: 45%; height: 100%; background: #3498db; border-radius: 3px;"></div>
                                </div>
                            </td>
                            <td>
                                <div class="operation-buttons">
                                    <button class="action-btn-small" style="color: #e74c3c;" title="暂停任务"><i class="fas fa-pause"></i></button>
                                    <button class="action-btn-small" title="变更策略"><i class="fas fa-cog"></i></button>
                                    <a href="detail_running.html" class="action-btn-small" title="查看详情"><i class="fas fa-eye"></i></a>
                                </div>
                            </td>
                        </tr>

                        <!-- 已完成的任务 -->
                        <tr>
                            <td>双11预热活动</td>
                            <td>6,000通</td>
                            <td>2025-11-10</td>
                            <td><span class="status-badge completed">已完成</span></td>
                            <td>2025-11-13 18:00</td>
                            <td>2025-11-13 16:30</td>
                            <td>0</td>
                            <td>35%</td>
                            <td>
                                <div class="progress-bar" style="width: 100%; height: 6px; background: #eee; border-radius: 3px;">
                                    <div class="progress-fill" style="width: 100%; height: 100%; background: #2ecc71; border-radius: 3px;"></div>
                                </div>
                            </td>
                            <td>
                                <div class="operation-buttons">
                                    <button class="action-btn-small" title="变更策略"><i class="fas fa-cog"></i></button>
                                    <a href="detail_completed.html" class="action-btn-small" title="查看详情"><i class="fas fa-eye"></i></a>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>用户满意度回访</td>
                            <td>2,500通</td>
                            <td>2025-11-05</td>
                            <td><span class="status-badge completed">已完成</span></td>
                            <td>2025-11-08 18:00</td>
                            <td>2025-11-08 17:45</td>
                            <td>0</td>
                            <td>42%</td>
                            <td>
                                <div class="progress-bar" style="width: 100%; height: 6px; background: #eee; border-radius: 3px;">
                                    <div class="progress-fill" style="width: 100%; height: 100%; background: #2ecc71; border-radius: 3px;"></div>
                                </div>
                            </td>
                            <td>
                                <div class="operation-buttons">
                                    <button class="action-btn-small" title="变更策略"><i class="fas fa-cog"></i></button>
                                    <a href="detail_completed.html" class="action-btn-small" title="查看详情"><i class="fas fa-eye"></i></a>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- 新建任务弹窗 -->
    <div id="createTaskModal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-container" style="max-width: 800px;">
            <div class="modal-header">
                <h2>新建任务</h2>
                <div class="modal-actions">
                    <button class="shortcut-btn" id="showShortcuts">
                        <i class="fas fa-keyboard"></i>
                        快捷键
                    </button>
                    <button class="close-modal-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="modal-content" style="display: block; padding: 24px;">
                <!-- 任务基本信息 -->
                <div class="task-section" style="margin-bottom: 24px;">
                    <h3 class="section-title">
                        <i class="fas fa-info-circle"></i>
                        任务基本信息
                    </h3>
                    <div class="form-group">
                        <label>任务名称</label>
                        <div class="input-with-actions">
                            <input type="text" id="taskName" placeholder="自动填充当前时间" value="2025-03-05 (13:28)" style="width: 100%;">
                            <div class="input-actions">
                                <button class="action-btn-small" id="copyTaskName">
                                    <i class="fas fa-copy"></i>
                                    复制
                                </button>
                                <button class="action-btn-small" id="clearTaskName">
                                    <i class="fas fa-eraser"></i>
                                    清空
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>执行优先级</label>
                        <div class="priority-selection">
                            <button class="priority-option-btn" data-priority="独享">独享</button>
                            <button class="priority-option-btn active" data-priority="优先">优先</button>
                            <button class="priority-option-btn" data-priority="正常">正常</button>
                            <button class="priority-option-btn" data-priority="滞后">滞后</button>
                            <div class="priority-desc">优先: 优先完成，适用于重要任务</div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>黑名单</label>
                        <div class="blacklist-setting">
                            <div class="toggle-switch">
                                <input type="checkbox" id="useBlacklistSwitch" checked>
                                <label for="useBlacklistSwitch"></label>
                                <span>使用黑名单功能</span>
                            </div>
                            <button class="blacklist-btn" id="manageBlacklist">
                                <i class="fas fa-ban"></i>
                                管理黑名单
                            </button>
                            <button class="import-btn" id="importBlacklist">
                                <i class="fas fa-file-import"></i>
                                一键导入
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 线索导入 -->
                <div class="task-section" style="margin-bottom: 24px;">
                    <h3 class="section-title">
                        <i class="fas fa-upload"></i>
                        线索导入
                    </h3>
                    <div class="import-card" style="box-shadow: none; border: 1px solid #eee;">
                        <div class="import-card-upload" style="padding: 30px; text-align: center; border: 2px dashed #ddd; border-radius: 8px; margin: 15px;">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 32px; color: #3498db; margin-bottom: 15px;"></i>
                            <span style="display: block; font-size: 16px; color: #2c3e50; margin-bottom: 8px;">点击或拖拽文件到此处</span>
                            <small style="display: block; color: #666; margin-bottom: 15px;">支持 .xlsx, .csv 格式</small>
                            <a href="manual.html" target="_blank" class="download-template-link">
                                <i class="fas fa-download"></i>
                                下载线索文件样例
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- 呼叫时间设置 -->
                <div class="task-section" style="margin-bottom: 24px;">
                    <h3 class="section-title">
                        <i class="fas fa-clock"></i>
                        呼叫时间设置
                    </h3>
                    <div class="form-group">
                        <div class="time-range" style="gap: 20px;">
                            <div class="time-input" style="flex: 1;">
                                <label>开始时间</label>
                                <input type="text" id="startTime" value="2025-03-05 13:28" readonly>
                            </div>
                            <div class="time-input" style="flex: 1;">
                                <label>结束时间</label>
                                <input type="text" id="endTime" value="2026-03-05 13:28" readonly>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>呼叫时间间隔</label>
                        <div class="interval-selection">
                            <button class="interval-btn active">自动</button>
                            <button class="interval-btn">1s</button>
                            <button class="interval-btn">3s</button>
                            <button class="interval-btn">5s</button>
                            <button class="interval-btn">10s</button>
                            <button class="interval-btn">30s</button>
                            <button class="interval-btn">60s</button>
                            <div class="custom-interval">
                                <input type="number" placeholder="自定义" min="1">
                                <span>秒</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 每周呼叫时间段 -->
                <div class="task-section">
                    <h3 class="section-title">
                        <i class="fas fa-calendar-alt"></i>
                        每周呼叫时间段
                    </h3>
                    <div class="form-group">
                        <div class="time-grid" id="weeklyTimeGrid">
                            <!-- 时间网格将通过JavaScript动态生成 -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="cancel-btn">取消</button>
                <button class="submit-btn">
                    <i class="fas fa-check"></i>
                    提交
                </button>
            </div>
        </div>

        <!-- 快捷键说明弹窗 -->
        <div id="shortcutsModal" class="modal">
            <div class="modal-overlay"></div>
            <div class="modal-container">
                <div class="modal-header">
                    <h2>快捷键说明</h2>
                    <button class="close-modal-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-content">
                    <div class="shortcuts-list">
                        <div class="shortcut-item">
                            <span class="key">Ctrl + Enter</span>
                            <span class="description">提交任务</span>
                        </div>
                        <div class="shortcut-item">
                            <span class="key">Esc</span>
                            <span class="description">关闭弹窗</span>
                        </div>
                        <div class="shortcut-item">
                            <span class="key">Ctrl + S</span>
                            <span class="description">保存当前设置</span>
                        </div>
                        <div class="shortcut-item">
                            <span class="key">Ctrl + Space</span>
                            <span class="description">快速添加标签</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 变更策略弹窗 (占位符，后续可拓展) -->
        <div id="changeStrategyModal" class="modal">
            <div class="modal-overlay"></div>
            <div class="modal-container">
                <div class="modal-header">
                    <h2>变更项目策略</h2>
                    <div class="modal-actions">
                        <button class="close-modal-btn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="modal-content">
                    <div class="placeholder-message">
                        <i class="fas fa-cog fa-spin"></i>
                        <p>变更策略功能正在开发中，即将上线...</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn">关闭</button>
                </div>
            </div>
        </div>

        <!-- 策略更改弹窗 -->
        <div id="strategyModal" class="modal">
            <div class="modal-overlay"></div>
            <div class="modal-container">
                <div class="modal-header">
                    <h2>更改执行策略</h2>
                    <button class="close-modal-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-content">
                    <div class="strategy-sections">
                        <!-- 任务优先级 -->
                        <div class="strategy-section">
                            <h3 class="section-title">
                                <i class="fas fa-flag"></i>
                                任务优先级
                            </h3>
                            <div class="priority-options">
                                <div class="priority-option" data-priority="独享">
                                    <div class="priority-badge p0">独享</div>
                                    <div class="priority-info">
                                        <div class="priority-name">独占资源</div>
                                        <div class="priority-desc">最高优先级，独占执行</div>
                                    </div>
                                </div>
                                <div class="priority-option selected" data-priority="优先">
                                    <div class="priority-badge p1">优先</div>
                                    <div class="priority-info">
                                        <div class="priority-name">优先完成</div>
                                        <div class="priority-desc">优先分配资源执行</div>
                                    </div>
                                </div>
                                <div class="priority-option" data-priority="正常">
                                    <div class="priority-badge p2">正常</div>
                                    <div class="priority-info">
                                        <div class="priority-name">标准优先级</div>
                                        <div class="priority-desc">按序执行任务</div>
                                    </div>
                                </div>
                                <div class="priority-option" data-priority="滞后">
                                    <div class="priority-badge p3">滞后</div>
                                    <div class="priority-info">
                                        <div class="priority-name">资源空闲</div>
                                        <div class="priority-desc">空闲时处理</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 身份策略 -->
                        <div class="strategy-section">
                            <h3 class="section-title">
                                <i class="fas fa-user-tie"></i>
                                身份策略
                            </h3>
                            <div class="identity-settings">
                                <div class="setting-group">
                                    <label>敬语等级</label>
                                    <select class="identity-select">
                                        <option value="standard">标准敬语</option>
                                        <option value="respectful">尊敬语</option>
                                        <option value="simple">简单敬语</option>
                                        <option value="random">随机</option>
                                    </select>
                                </div>
                                <div class="setting-group">
                                    <label>方言适配</label>
                                    <div class="toggle-group">
                                        <button class="toggle-btn active">开启</button>
                                        <button class="toggle-btn">关闭</button>
                                        <button class="toggle-btn">自动</button>
                                    </div>
                                </div>
                                <div class="dialect-options">
                                    <label>支持的方言：</label>
                                    <div class="dialect-tags">
                                        <span class="dialect-tag">关西腔<i class="fas fa-times"></i></span>
                                        <span class="dialect-tag">神道教用语<i class="fas fa-times"></i></span>
                                        <button class="add-dialect-btn">
                                            <i class="fas fa-plus"></i>
                                            添加方言
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 知识库权限 -->
                        <div class="strategy-section">
                            <h3 class="section-title">
                                <i class="fas fa-book"></i>
                                知识库权限
                            </h3>
                            <div class="knowledge-settings">
                                <div class="setting-group">
                                    <label>权限模式</label>
                                    <div class="toggle-group">
                                        <button class="toggle-btn active">动态请求</button>
                                        <button class="toggle-btn">固定权限</button>
                                        <button class="toggle-btn">无限制</button>
                                    </div>
                                </div>
                                <div class="knowledge-bases">
                                    <div class="knowledge-base">
                                        <div class="base-header">
                                            <span class="base-name">产品知识库</span>
                                            <label class="switch">
                                                <input type="checkbox" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="knowledge-base">
                                        <div class="base-header">
                                            <span class="base-name">服务话术库</span>
                                            <label class="switch">
                                                <input type="checkbox" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="knowledge-base">
                                        <div class="base-header">
                                            <span class="base-name">FAQ库</span>
                                            <label class="switch">
                                                <input type="checkbox">
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- RPA流程 -->
                        <div class="strategy-section">
                            <h3 class="section-title">
                                <i class="fas fa-robot"></i>
                                RPA流程
                            </h3>
                            <div class="rpa-settings">
                                <div class="setting-group">
                                    <label>RPA状态</label>
                                    <div class="toggle-group">
                                        <button class="toggle-btn">启用</button>
                                        <button class="toggle-btn active">未启用</button>
                                        <button class="toggle-btn">条件触发</button>
                                    </div>
                                </div>
                                <div class="rpa-flows">
                                    <div class="rpa-flow">
                                        <div class="flow-header">
                                            <span class="flow-name">自动记录客户信息</span>
                                            <label class="switch">
                                                <input type="checkbox" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                        <div class="flow-trigger">
                                            触发条件：通话结束后
                                        </div>
                                    </div>
                                    <div class="rpa-flow">
                                        <div class="flow-header">
                                            <span class="flow-name">数据同步至CRM</span>
                                            <label class="switch">
                                                <input type="checkbox">
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                        <div class="flow-trigger">
                                            触发条件：信息更新时
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn">取消</button>
                    <button class="submit-btn">保存更改</button>
                </div>
            </div>
        </div>

        <!-- 变更策略弹窗 -->
        <div id="newStrategyModal" class="modal">
            <div class="modal-overlay"></div>
            <div class="modal-container">
                <div class="modal-header">
                    <h2>变更执行策略</h2>
                    <button class="close-modal-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-content">
                    <!-- 任务拖拽区域 -->
                    <div class="draggable-tasks-section">
                        <h3 class="section-title">
                            <i class="fas fa-tasks"></i>
                            当前执行任务 (拖拽调整优先级)
                        </h3>
                        <div class="task-list" id="draggableTaskList">
                            <!-- 任务卡片将通过JavaScript动态生成 -->
                        </div>
                    </div>

                    <!-- 策略设置区域 -->
                    <div class="strategy-settings-section">
                        <h3 class="section-title">
                            <i class="fas fa-cog"></i>
                            策略设置
                        </h3>
                        <div class="strategy-grid">
                            <!-- 执行优先级 -->
                            <div class="strategy-item">
                                <div class="strategy-item-header">
                                    <h4>执行优先级</h4>
                                    <div class="strategy-controls">
                                        <button class="strategy-btn" data-priority="high">高</button>
                                        <button class="strategy-btn active" data-priority="medium">中</button>
                                        <button class="strategy-btn" data-priority="low">低</button>
                                    </div>
                                </div>
                            </div>

                            <!-- 并发设置 -->
                            <div class="strategy-item">
                                <div class="strategy-item-header">
                                    <h4>并发设置</h4>
                                    <div class="strategy-controls">
                                        <button class="strategy-btn" data-action="decrease">-</button>
                                        <span class="strategy-value">50</span>
                                        <button class="strategy-btn" data-action="increase">+</button>
                                    </div>
                                </div>
                            </div>

                            <!-- 执行时间 -->
                            <div class="strategy-item">
                                <div class="strategy-item-header">
                                    <h4>执行时间</h4>
                                    <div class="strategy-controls">
                                        <input type="time" value="09:00" class="strategy-btn">
                                        <span>至</span>
                                        <input type="time" value="18:00" class="strategy-btn">
                                    </div>
                                </div>
                            </div>

                            <!-- 执行频率 -->
                            <div class="strategy-item">
                                <div class="strategy-item-header">
                                    <h4>执行频率</h4>
                                    <div class="strategy-controls">
                                        <select class="strategy-btn">
                                            <option value="1">每秒1次</option>
                                            <option value="2">每秒2次</option>
                                            <option value="5" selected>每秒5次</option>
                                            <option value="10">每秒10次</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 高级设置 -->
                        <div class="strategy-section">
                            <h3 class="section-title">高级设置</h3>
                            <div class="strategy-grid">
                                <div class="strategy-item">
                                    <div class="strategy-item-header">
                                        <h4>话术设置</h4>
                                        <div class="strategy-controls">
                                            <select class="strategy-btn">
                                                <option value="script1">标准营销话术</option>
                                                <option value="script2">温和推广话术</option>
                                                <option value="script3">活动推广话术</option>
                                            </select>
                                            <button class="strategy-btn">
                                                <i class="fas fa-edit"></i>
                                                编辑
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="strategy-item">
                                    <div class="strategy-item-header">
                                        <h4>智能调度</h4>
                                        <div class="strategy-controls">
                                            <label class="toggle-switch">
                                                <input type="checkbox" checked>
                                                <span class="slider round"></span>
                                                <span class="label">自动负载均衡</span>
                                            </label>
                                            <label class="toggle-switch">
                                                <input type="checkbox" checked>
                                                <span class="slider round"></span>
                                                <span class="label">智能重试</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn">取消</button>
                    <button class="submit-btn">保存更改</button>
                </div>
            </div>
        </div>

        <!-- 变更策略弹窗 - 使用iframe方式 -->
        <div id="strategyModalFrame" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 99999;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 1200px; height: 90vh; background: white; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); display: flex; flex-direction: column; overflow: hidden;">
                <div style="padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                    <h2 style="margin: 0; font-size: 18px; color: #333;">变更执行策略</h2>
                    <button id="closeStrategyModal" style="background: none; border: none; font-size: 20px; cursor: pointer;">&times;</button>
                </div>
                <div style="flex: 1; overflow-y: auto; padding: 20px; background: #f8f9fa;">
                    <!-- 任务拖拽区域 -->
                    <div style="background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                        <h3 style="font-size: 16px; font-weight: 500; color: #2c3e50; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee;">
                            <i class="fas fa-tasks"></i>
                            当前执行任务 (拖拽调整优先级)
                        </h3>
                        <div id="taskListContainer" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; margin-top: 15px;">
                            <!-- 任务卡片将通过JavaScript动态生成 -->
                        </div>
                    </div>

                    <!-- 策略设置区域 -->
                    <div style="background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                        <h3 style="font-size: 16px; font-weight: 500; color: #2c3e50; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee;">
                            <i class="fas fa-cog"></i>
                            策略设置
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                            <!-- 执行优先级 -->
                            <div style="background: #f8f9fa; border-radius: 8px; padding: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h4 style="margin: 0; color: #2c3e50; font-size: 14px; font-weight: 500;">执行优先级</h4>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <button class="priority-btn" data-priority="high" style="padding: 6px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; background: white; color: #666; cursor: pointer;">高</button>
                                        <button class="priority-btn active" data-priority="medium" style="padding: 6px 12px; border: 1px solid #3498db; border-radius: 4px; font-size: 13px; background: #3498db; color: white; cursor: pointer;">中</button>
                                        <button class="priority-btn" data-priority="low" style="padding: 6px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; background: white; color: #666; cursor: pointer;">低</button>
                                    </div>
                                </div>
                            </div>

                            <!-- 并发设置 -->
                            <div style="background: #f8f9fa; border-radius: 8px; padding: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h4 style="margin: 0; color: #2c3e50; font-size: 14px; font-weight: 500;">并发设置</h4>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <button class="concurrency-btn" data-action="decrease" style="padding: 6px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; background: white; color: #666; cursor: pointer;">-</button>
                                        <span id="concurrencyValue" style="font-size: 14px; font-weight: 500; color: #2c3e50;">50</span>
                                        <button class="concurrency-btn" data-action="increase" style="padding: 6px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; background: white; color: #666; cursor: pointer;">+</button>
                                    </div>
                                </div>
                            </div>

                            <!-- 执行时间 -->
                            <div style="background: #f8f9fa; border-radius: 8px; padding: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h4 style="margin: 0; color: #2c3e50; font-size: 14px; font-weight: 500;">执行时间</h4>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <input type="time" value="09:00" style="padding: 6px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; background: white;">
                                        <span>至</span>
                                        <input type="time" value="18:00" style="padding: 6px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; background: white;">
                                    </div>
                                </div>
                            </div>

                            <!-- 执行频率 -->
                            <div style="background: #f8f9fa; border-radius: 8px; padding: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h4 style="margin: 0; color: #2c3e50; font-size: 14px; font-weight: 500;">执行频率</h4>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <select style="padding: 6px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; background: white;">
                                            <option value="1">每秒1次</option>
                                            <option value="2">每秒2次</option>
                                            <option value="5" selected>每秒5次</option>
                                            <option value="10">每秒10次</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 高级设置 -->
                        <div>
                            <h3 style="font-size: 16px; font-weight: 500; color: #2c3e50; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee;">高级设置</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                                <div style="background: #f8f9fa; border-radius: 8px; padding: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <h4 style="margin: 0; color: #2c3e50; font-size: 14px; font-weight: 500;">话术设置</h4>
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <select style="padding: 6px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; background: white;">
                                                <option value="script1">标准营销话术</option>
                                                <option value="script2">温和推广话术</option>
                                                <option value="script3">活动推广话术</option>
                                            </select>
                                            <button style="padding: 6px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; background: white; color: #666; cursor: pointer;">
                                                <i class="fas fa-edit"></i>
                                                编辑
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div style="background: #f8f9fa; border-radius: 8px; padding: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <h4 style="margin: 0; color: #2c3e50; font-size: 14px; font-weight: 500;">智能调度</h4>
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <label style="display: flex; align-items: center; gap: 8px;">
                                                <input type="checkbox" checked style="margin: 0;">
                                                <span>自动负载均衡</span>
                                            </label>
                                            <label style="display: flex; align-items: center; gap: 8px;">
                                                <input type="checkbox" checked style="margin: 0;">
                                                <span>智能重试</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="padding: 20px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 10px;">
                    <button id="cancelStrategyBtn" style="padding: 8px 16px; background-color: #f8f9fa; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; color: #666; cursor: pointer;">取消</button>
                    <button id="saveStrategyBtn" style="padding: 8px 16px; background-color: #3498db; border: none; border-radius: 4px; font-size: 14px; color: white; cursor: pointer;">保存更改</button>
                </div>
            </div>
        </div>

        <!-- 队列项目弹窗 -->
        <div id="queueProjectsModal" class="modal" style="display: none;">
            <div class="modal-overlay"></div>
            <div class="modal-container">
                <div class="modal-header">
                    <h3>队列任务详情</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-content">
                    <table class="task-table">
                        <thead>
                            <tr>
                                <th>任务名称</th>
                                <th>优先级</th>
                                <th>预计开始时间</th>
                                <th>状态</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>双12特惠</td>
                                <td><span class="priority-badge priority-high">高</span></td>
                                <td>2024-12-10</td>
                                <td><span class="status-badge status-waiting">等待中</span></td>
                            </tr>
                            <!-- 更多任务... -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 任务队列弹窗 -->
        <div id="taskQueueModal" class="modal" style="display: none;">
            <div class="modal-overlay"></div>
            <div class="modal-container">
                <div class="modal-header">
                    <h3>任务队列详情</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-content">
                    <table class="task-table">
                        <thead>
                            <tr>
                                <th>电话号码</th>
                                <th>加入时间</th>
                                <th>预计执行时间</th>
                                <th>优先级</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>134****4444</td>
                                <td>14:28:10</td>
                                <td>14:35:00</td>
                                <td><span class="priority-badge priority-high">高</span></td>
                            </tr>
                            <!-- 更多任务... -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 执行中任务弹窗 -->
        <div id="runningTasksModal" class="modal" style="display: none;">
            <div class="modal-overlay"></div>
            <div class="modal-container">
                <div class="modal-header">
                    <h3>执行中任务详情</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-content">
                    <table class="task-table">
                        <thead>
                            <tr>
                                <th>电话号码</th>
                                <th>开始时间</th>
                                <th>已用时长</th>
                                <th>状态</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>135****5555</td>
                                <td>14:30:00</td>
                                <td>30秒</td>
                                <td><span class="status-badge status-running">通话中</span></td>
                            </tr>
                            <!-- 更多任务... -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <script>
            // 更新当前时间
            function updateTime() {
                const currentTimeElement = document.getElementById('currentTime');
                if (!currentTimeElement) return; // 如果元素不存在，直接返回
                
                const now = new Date();
                const year = now.getFullYear();
                const month = now.getMonth() + 1;
                const day = now.getDate();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const seconds = now.getSeconds().toString().padStart(2, '0');
                
                const formattedTime = `${year}年${month}月${day}日 ${hours}:${minutes}:${seconds}`;
                currentTimeElement.textContent = formattedTime;
            }

            // 弹窗相关函数
            function showModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('show');
                }
            }

            function hideModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.remove('show');
                }
            }

            function hideAllModals() {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    modal.classList.remove('show');
                });
            }

            // 生成时间网格
            function generateTimeGrid() {
                const weekDays = ['', '周一', '周二', '周三', '周四', '周五', '周六', '周日'];
                const hours = Array.from({length: 12}, (_, i) => i + 8); // 8:00 - 19:00
                
                const grid = document.getElementById('weeklyTimeGrid');
                
                // 添加表头
                const header = document.createElement('div');
                header.className = 'time-grid-header';
                weekDays.forEach(day => {
                    const cell = document.createElement('div');
                    cell.className = 'time-cell';
                    cell.textContent = day;
                    header.appendChild(cell);
                });
                grid.appendChild(header);
                
                // 添加时间行
                hours.forEach(hour => {
                    const row = document.createElement('div');
                    row.className = 'time-row';
                    
                    // 添加时间列
                    const timeCell = document.createElement('div');
                    timeCell.className = 'time-cell';
                    timeCell.textContent = `${hour}:00`;
                    row.appendChild(timeCell);
                    
                    // 添加每天的单元格
                    for(let i = 1; i <= 7; i++) {
                        const cell = document.createElement('div');
                        cell.className = 'time-cell';
                        // 设置工作时间为蓝色
                        if (i <= 5 && hour >= 9 && hour <= 18 && hour !== 12) {
                            cell.classList.add('active');
                        }
                        cell.addEventListener('click', () => {
                            cell.classList.toggle('active');
                        });
                        row.appendChild(cell);
                    }
                    
                    grid.appendChild(row);
                });
            }

            // 处理标签添加
            function handleTagAddition() {
                const addTagBtn = document.getElementById('addTagBtn');
                // 添加null检查，防止错误
                if (!addTagBtn) {
                    console.log('未找到addTagBtn元素，跳过标签添加功能初始化');
                    return;
                }
                
                const tagsContainer = addTagBtn.parentElement;
                
                addTagBtn.addEventListener('click', (e) => {
                    const tagInput = document.createElement('div');
                    tagInput.className = 'tag-input-modal';
                    tagInput.innerHTML = `
                        <div class="tag-input-container">
                            <input type="text" placeholder="输入标签名称">
                            <button>添加</button>
                        </div>
                    `;
                    
                    // 定位输入框
                    const rect = addTagBtn.getBoundingClientRect();
                    tagInput.style.top = rect.bottom + 5 + 'px';
                    tagInput.style.left = rect.left + 'px';
                    
                    document.body.appendChild(tagInput);
                    const input = tagInput.querySelector('input');
                    input.focus();
                    
                    // 处理添加按钮点击
                    tagInput.querySelector('button').addEventListener('click', () => {
                        const tagText = input.value.trim();
                        if (tagText) {
                            const tag = document.createElement('div');
                            tag.className = 'tag';
                            tag.innerHTML = `${tagText}<i class="fas fa-times"></i>`;
                            
                            // 添加删除功能
                            tag.querySelector('i').addEventListener('click', () => {
                                tag.remove();
                            });
                            
                            tagsContainer.insertBefore(tag, addTagBtn);
                        }
                        tagInput.remove();
                    });
                    
                    // 处理点击外部关闭
                    document.addEventListener('click', function closeTagInput(e) {
                        if (!tagInput.contains(e.target) && e.target !== addTagBtn) {
                            tagInput.remove();
                            document.removeEventListener('click', closeTagInput);
                        }
                    });
                });
            }

            // 处理快捷键
            function handleShortcuts() {
                const showShortcutsBtn = document.getElementById('showShortcuts');
                const shortcutsModal = document.getElementById('shortcutsModal');
                
                showShortcutsBtn.addEventListener('click', () => {
                    shortcutsModal.classList.add('show');
                });
                
                // 关闭快捷键弹窗
                shortcutsModal.querySelector('.close-modal-btn').addEventListener('click', () => {
                    shortcutsModal.classList.remove('show');
                });
                
                // 添加实际的快捷键功能
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey && e.key === 'Enter') {
                        // 提交任务
                        document.querySelector('.submit-btn').click();
                    } else if (e.key === 'Escape') {
                        // 关闭弹窗
                        hideAllModals();
                    } else if (e.ctrlKey && e.key === 's') {
                        // 保存设置
                        e.preventDefault();
                        // TODO: 实现保存功能
                    } else if (e.ctrlKey && e.key === ' ') {
                        // 快速添加标签
                        e.preventDefault();
                        document.getElementById('addTagBtn').click();
                    }
                });
            }

            // 处理黑名单管理
            function handleBlacklist() {
                const manageBlacklistBtn = document.getElementById('manageBlacklist');
                const importBlacklistBtn = document.getElementById('importBlacklist');
                
                manageBlacklistBtn.addEventListener('click', () => {
                    // TODO: 实现黑名单管理弹窗
                    alert('黑名单管理功能即将上线');
                });
                
                importBlacklistBtn.addEventListener('click', () => {
                    // TODO: 实现黑名单导入弹窗
                    alert('黑名单导入功能即将上线');
                });
            }

            // 处理时间间隔选择
            function handleIntervalSelection() {
                const intervalBtns = document.querySelectorAll('.interval-btn');
                const customIntervalInput = document.querySelector('.custom-interval input');
                
                intervalBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        intervalBtns.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        customIntervalInput.value = ''; // 清空自定义输入
                    });
                });
                
                customIntervalInput.addEventListener('input', () => {
                    // 当输入自定义值时，取消其他按钮的选中状态
                    intervalBtns.forEach(btn => btn.classList.remove('active'));
                });
            }

            // 初始化所有功能
            function initializeTaskModal() {
                try {
                    // 检查每个DOM元素是否存在后再操作
                    if (document.getElementById('weeklyTimeGrid')) {
                        generateTimeGrid();
                    }
                    
                    handleTagAddition(); // 已添加null检查
                    
                    if (document.querySelector('.shortcut-item')) {
                        handleShortcuts();
                    }
                    
                    if (document.getElementById('manageBlacklist')) {
                        handleBlacklist();
                    }
                    
                    if (document.querySelector('.interval-btn')) {
                        handleIntervalSelection();
                    }
                    
                    // 仅当存在相关元素时初始化策略控制
                    if (document.querySelector('.strategy-btn')) {
                        initializeStrategyControls();
                    }
                    
                    if (document.getElementById('strategyModal')) {
                        initializeStrategyModal();
                    }
                    
                    // 复制任务名称
                    const copyTaskNameBtn = document.getElementById('copyTaskName');
                    if (copyTaskNameBtn) {
                        copyTaskNameBtn.addEventListener('click', () => {
                            const taskName = document.getElementById('taskName');
                            if (taskName) {
                                navigator.clipboard.writeText(taskName.value)
                                    .then(() => alert('任务名称已复制'))
                                    .catch(err => console.error('复制失败:', err));
                            }
                        });
                    }
                    
                    // 清空任务名称
                    const clearTaskNameBtn = document.getElementById('clearTaskName');
                    if (clearTaskNameBtn) {
                        clearTaskNameBtn.addEventListener('click', () => {
                            const taskName = document.getElementById('taskName');
                            if (taskName) {
                                taskName.value = '';
                            }
                        });
                    }
                    
                    // 提交表单
                    const submitBtn = document.querySelector('.submit-btn');
                    if (submitBtn) {
                        submitBtn.addEventListener('click', () => {
                            // TODO: 实现表单提交逻辑
                            alert('任务创建成功！');
                            if (typeof hideAllModals === 'function') {
                                hideAllModals();
                            }
                        });
                    }
                } catch (error) {
                    console.error('初始化任务模态窗口时出错:', error);
                }
            }

            // 确保页面完全加载后再初始化
            document.addEventListener('DOMContentLoaded', function() {
                console.log('DOM fully loaded');
                
                try {
                    initializeTaskModal();
                    initializeStrategyControls(); // 添加策略控制初始化
                    
                    // 初始化时间并每秒更新
                    updateTime();
                    setInterval(updateTime, 1000);
    
                    // 添加充值按钮事件
                    const rechargeBtn = document.querySelector('.agent-recharge-btn');
                    if (rechargeBtn) {
                        rechargeBtn.addEventListener('click', function() {
                            console.log('Recharge button clicked');
                            alert('充值功能即将上线');
                        });
                    }
    
                    // 新建任务按钮点击事件
                    const createTaskBtn = document.querySelector('.create-task-btn');
                    if (createTaskBtn) {
                        createTaskBtn.addEventListener('click', function(e) {
                            e.preventDefault();
                            console.log('Create task button clicked');
                            showModal('createTaskModal');
                        });
                    }
    
                    // 变更策略按钮点击事件
                    const changeStrategyBtn = document.querySelector('.change-strategy-btn');
                    if (changeStrategyBtn) {
                        changeStrategyBtn.addEventListener('click', function(e) {
                            e.preventDefault();
                            console.log('Change strategy button clicked');
                            showModal('changeStrategyModal');
                        });
                    }
    
                    // 关闭按钮事件
                    document.querySelectorAll('.close-modal-btn, .cancel-btn').forEach(btn => {
                        btn.addEventListener('click', function(e) {
                            e.preventDefault();
                            hideAllModals();
                        });
                    });
                    
                    // 点击遮罩层关闭弹窗
                    document.querySelectorAll('.modal-overlay').forEach(overlay => {
                        overlay.addEventListener('click', function(e) {
                            if (e.target === this) {
                                hideAllModals();
                            }
                        });
                    });
                    
                    // 阻止弹窗内容点击事件冒泡
                    document.querySelectorAll('.modal-container').forEach(container => {
                        container.addEventListener('click', function(e) {
                            e.stopPropagation();
                        });
                    });
                    
                    // 时间格子点击事件
                    document.querySelectorAll('.time-cell:not(:first-child)').forEach(cell => {
                        cell.addEventListener('click', function() {
                            this.classList.toggle('active');
                        });
                    });
                    
                    // 持续时间按钮点击事件
                    document.querySelectorAll('.duration-btn').forEach(btn => {
                        btn.addEventListener('click', function() {
                            document.querySelectorAll('.duration-btn').forEach(b => b.classList.remove('active'));
                            this.classList.add('active');
                        });
                    });
                    
                    // 间隔按钮点击事件
                    document.querySelectorAll('.interval-btn').forEach(btn => {
                        btn.addEventListener('click', function() {
                            document.querySelectorAll('.interval-btn').forEach(b => b.classList.remove('active'));
                            this.classList.add('active');
                        });
                    });
                    
                    // 导出报告弹窗功能
                    const exportBtn = document.getElementById('exportReportBtn');
                    const exportPopup = document.getElementById('exportOptionsPopup');
                    const popupOverlay = document.getElementById('popupOverlay');
                    
                    if (exportBtn && exportPopup && popupOverlay) {
                        console.log('找到导出按钮和弹窗元素'); // 调试用
                        
                        // 移除可能存在的旧事件监听器
                        const newExportBtn = exportBtn.cloneNode(true);
                        exportBtn.parentNode.replaceChild(newExportBtn, exportBtn);
                        
                        // 添加新的事件监听器
                        newExportBtn.addEventListener('click', function(e) {
                            console.log('导出按钮被点击'); // 调试用
                            e.preventDefault(); // 阻止默认行为
                            e.stopPropagation(); // 阻止事件冒泡
                            
                            // 获取按钮位置并定位弹窗
                            const btnRect = newExportBtn.getBoundingClientRect();
                            exportPopup.style.top = (btnRect.bottom + window.scrollY + 5) + 'px';
                            exportPopup.style.left = (btnRect.left + window.scrollX) + 'px';
                            
                            // 显示弹窗和遮罩层
                            exportPopup.style.display = 'block';
                            popupOverlay.style.display = 'block';
                        });
                        
                        // 导出报告功能
                        window.exportReport = function(type) {
                            let message = '';
                            
                            switch(type) {
                                case 'excel':
                                    message = '开始导出Excel表格...';
                                    break;
                                case 'pdf':
                                    message = '开始导出PDF文档...';
                                    break;
                                case 'csv':
                                    message = '开始导出CSV格式...';
                                    break;
                                case 'print':
                                    message = '准备打印报告...';
                                    break;
                            }
                            
                            alert(message);
                            
                            // 关闭弹窗
                            exportPopup.style.display = 'none';
                            popupOverlay.style.display = 'none';
                        };
                        
                        // 点击遮罩层关闭弹窗
                        popupOverlay.addEventListener('click', function() {
                            exportPopup.style.display = 'none';
                            popupOverlay.style.display = 'none';
                        });
                        
                        // 阻止弹窗点击事件冒泡
                        exportPopup.addEventListener('click', function(e) {
                            e.stopPropagation();
                        });
                    }
                } catch (error) {
                    console.error('初始化页面时出错:', error);
                }
            });

            // 添加全局点击处理程序
            document.addEventListener('click', function(e) {
                if (e.target.closest('#promotion-project')) {
                    e.preventDefault();
                    window.location.href = 'detail1.html';
                }
            });

            // 添加策略管理相关的函数
            function initializeStrategyControls() {
                // 处理标签编辑
                document.querySelectorAll('.edit-tag-btn').forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const tag = this.closest('.strategy-tag');
                        const tagValue = tag.querySelector('.tag-value');
                        const currentValue = tagValue.textContent;
                        
                        // 创建编辑弹窗
                        const editModal = document.createElement('div');
                        editModal.className = 'tag-edit-modal';
                        editModal.innerHTML = `
                            <div class="tag-edit-content">
                                <h3>编辑${tag.querySelector('.tag-label').textContent}</h3>
                                <div class="edit-options">
                                    ${getOptionsForTag(tag.className)}
                                </div>
                                <div class="edit-actions">
                                    <button class="cancel-edit-btn">取消</button>
                                    <button class="save-edit-btn">保存</button>
                                </div>
                            </div>
                        `;
                        
                        document.body.appendChild(editModal);
                        
                        // 定位弹窗
                        const rect = tag.getBoundingClientRect();
                        editModal.style.top = rect.bottom + 5 + 'px';
                        editModal.style.left = rect.left + 'px';
                        
                        // 处理选项点击
                        editModal.querySelectorAll('.edit-option').forEach(option => {
                            option.addEventListener('click', function() {
                                editModal.querySelectorAll('.edit-option').forEach(opt => 
                                    opt.classList.remove('selected'));
                                this.classList.add('selected');
                            });
                        });
                        
                        // 处理保存按钮
                        editModal.querySelector('.save-edit-btn').addEventListener('click', function() {
                            const selectedOption = editModal.querySelector('.edit-option.selected');
                            if (selectedOption) {
                                tagValue.textContent = selectedOption.textContent;
                                editModal.remove();
                            }
                        });
                        
                        // 处理取消按钮
                        editModal.querySelector('.cancel-edit-btn').addEventListener('click', function() {
                            editModal.remove();
                        });
                        
                        // 处理点击外部关闭
                        document.addEventListener('click', function closeEditModal(e) {
                            if (!editModal.contains(e.target) && !tag.contains(e.target)) {
                                editModal.remove();
                                document.removeEventListener('click', closeEditModal);
                            }
                        });
                    });
                });
                
                // 处理并发数调整
                const upgradeBtn = document.querySelector('.upgrade-btn');
                if (upgradeBtn) {
                    upgradeBtn.addEventListener('click', function() {
                        // 创建并发购买弹窗
                        const purchaseModal = document.createElement('div');
                        purchaseModal.className = 'modal purchase-modal';
                        purchaseModal.innerHTML = `
                            <div class="modal-overlay"></div>
                            <div class="modal-container">
                                <div class="modal-header">
                                    <h2>提升并发数</h2>
                                    <button class="close-modal-btn">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                <div class="modal-content">
                                    <div class="purchase-options">
                                        <div class="purchase-option">
                                            <h3>基础版</h3>
                                            <div class="price">¥999/月</div>
                                        </div>
                                        <div class="purchase-option recommended">
                                            <h3>专业版</h3>
                                            <div class="price">¥1999/月</div>
                                        </div>
                                        <div class="purchase-option">
                                            <h3>企业版</h3>
                                            <div class="price">¥4999/月</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        document.body.appendChild(purchaseModal);
                        setTimeout(() => purchaseModal.classList.add('show'), 0);
                        
                        // 处理关闭按钮
                        purchaseModal.querySelector('.close-modal-btn').addEventListener('click', function() {
                            purchaseModal.classList.remove('show');
                            setTimeout(() => purchaseModal.remove(), 300);
                        });
                        
                        // 处理购买按钮
                        purchaseModal.querySelectorAll('.purchase-btn').forEach(btn => {
                            btn.addEventListener('click', function() {
                                alert('购买功能即将上线');
                                purchaseModal.classList.remove('show');
                                setTimeout(() => purchaseModal.remove(), 300);
                            });
                        });
                    });
                }
                
                // 处理策略更改按钮
                const changeStrategyBtn = document.querySelector('.change-strategy-btn');
                if (changeStrategyBtn) {
                    changeStrategyBtn.addEventListener('click', function() {
                        showModal('strategyModal');
                    });
                }
            }
            
            // 获取不同标签类型的选项
            function getOptionsForTag(className) {
                const options = {
                    'priority-tag': ['独享', '优先', '正常', '滞后'],
                    'identity-tag': ['标准敬语', '尊敬语', '简单敬语', '随机'],
                    'dialect-tag': ['已开启', '已关闭', '自动'],
                    'knowledge-tag': ['动态请求', '固定权限', '无限制'],
                    'rpa-tag': ['已启用', '未启用', '条件触发']
                };
                
                let tagType = '';
                for (const type in options) {
                    if (className.includes(type)) {
                        tagType = type;
                        break;
                    }
                }
                
                return options[tagType]
                    .map(opt => `<div class="edit-option${opt === document.querySelector('.' + tagType + ' .tag-value').textContent ? ' selected' : ''}">${opt}</div>`)
                    .join('');
            }

            // 添加策略弹窗相关的函数
            function initializeStrategyModal() {
                // 处理优先级选择
                document.querySelectorAll('.priority-option').forEach(option => {
                    option.addEventListener('click', function() {
                        document.querySelectorAll('.priority-option').forEach(opt => 
                            opt.classList.remove('selected'));
                        this.classList.add('selected');
                        
                        // 更新标签显示
                        const priorityTag = document.querySelector('.priority-tag .tag-value');
                        if (priorityTag) {
                            priorityTag.textContent = this.dataset.priority;
                        }
                    });
                });
                
                // 处理身份策略选择
                const identitySelect = document.querySelector('.identity-select');
                if (identitySelect) {
                    identitySelect.addEventListener('change', function() {
                        const identityTag = document.querySelector('.identity-tag .tag-value');
                        if (identityTag) {
                            identityTag.textContent = this.options[this.selectedIndex].text;
                        }
                    });
                }
                
                // 处理方言适配开关
                document.querySelectorAll('.dialect-options .toggle-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.dialect-options .toggle-btn').forEach(b => 
                            b.classList.remove('active'));
                        this.classList.add('active');
                        
                        const dialectTag = document.querySelector('.dialect-tag .tag-value');
                        if (dialectTag) {
                            dialectTag.textContent = this.textContent;
                        }
                    });
                });
                
                // 处理方言标签删除
                document.querySelectorAll('.dialect-tag .fa-times').forEach(closeBtn => {
                    closeBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        this.closest('.dialect-tag').remove();
                    });
                });
                
                // 处理添加方言按钮
                const addDialectBtn = document.querySelector('.add-dialect-btn');
                if (addDialectBtn) {
                    addDialectBtn.addEventListener('click', function() {
                        const dialectInput = document.createElement('div');
                        dialectInput.className = 'tag-input-modal';
                        dialectInput.innerHTML = `
                            <div class="tag-input-container">
                                <input type="text" placeholder="输入方言名称">
                                <button>添加</button>
                            </div>
                        `;
                        
                        const rect = this.getBoundingClientRect();
                        dialectInput.style.top = rect.bottom + 5 + 'px';
                        dialectInput.style.left = rect.left + 'px';
                        
                        document.body.appendChild(dialectInput);
                        const input = dialectInput.querySelector('input');
                        input.focus();
                        
                        // 处理添加按钮点击
                        dialectInput.querySelector('button').addEventListener('click', () => {
                            const dialectText = input.value.trim();
                            if (dialectText) {
                                const dialectTag = document.createElement('span');
                                dialectTag.className = 'dialect-tag';
                                dialectTag.innerHTML = `${dialectText}<i class="fas fa-times"></i>`;
                                
                                // 添加删除功能
                                dialectTag.querySelector('i').addEventListener('click', (e) => {
                                    e.stopPropagation();
                                    dialectTag.remove();
                                });
                                
                                addDialectBtn.parentElement.insertBefore(dialectTag, addDialectBtn);
                            }
                            dialectInput.remove();
                        });
                        
                        // 处理点击外部关闭
                        document.addEventListener('click', function closeDialectInput(e) {
                            if (!dialectInput.contains(e.target) && e.target !== addDialectBtn) {
                                dialectInput.remove();
                                document.removeEventListener('click', closeDialectInput);
                            }
                        });
                    });
                }
                
                // 处理知识库权限模式选择
                document.querySelectorAll('.knowledge-settings .toggle-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.knowledge-settings .toggle-btn').forEach(b => 
                            b.classList.remove('active'));
                        this.classList.add('active');
                        
                        const knowledgeTag = document.querySelector('.knowledge-tag .tag-value');
                        if (knowledgeTag) {
                            knowledgeTag.textContent = this.textContent;
                        }
                    });
                });
                
                // 处理知识库开关
                document.querySelectorAll('.knowledge-base .switch input').forEach(checkbox => {
                    checkbox.addEventListener('change', function() {
                        const baseName = this.closest('.knowledge-base').querySelector('.base-name').textContent;
                        console.log(`${baseName} 权限: ${this.checked ? '开启' : '关闭'}`);
                    });
                });
                
                // 处理RPA状态选择
                document.querySelectorAll('.rpa-settings .toggle-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.rpa-settings .toggle-btn').forEach(b => 
                            b.classList.remove('active'));
                        this.classList.add('active');
                        
                        const rpaTag = document.querySelector('.rpa-tag .tag-value');
                        if (rpaTag) {
                            rpaTag.textContent = this.textContent;
                        }
                    });
                });
                
                // 处理RPA流程开关
                document.querySelectorAll('.rpa-flow .switch input').forEach(checkbox => {
                    checkbox.addEventListener('change', function() {
                        const flowName = this.closest('.rpa-flow').querySelector('.flow-name').textContent;
                        console.log(`${flowName}: ${this.checked ? '启用' : '禁用'}`);
                    });
                });
                
                // 处理保存按钮
                document.querySelector('#strategyModal .submit-btn').addEventListener('click', function() {
                    // 收集所有设置
                    const settings = {
                        priority: document.querySelector('.priority-option.selected').dataset.priority,
                        identity: document.querySelector('.identity-select').value,
                        dialect: document.querySelector('.dialect-options .toggle-btn.active').textContent,
                        dialects: Array.from(document.querySelectorAll('.dialect-tag')).map(tag => 
                            tag.textContent.replace(/×$/, '')),
                        knowledgeMode: document.querySelector('.knowledge-settings .toggle-btn.active').textContent,
                        knowledgeBases: Array.from(document.querySelectorAll('.knowledge-base')).map(base => ({
                            name: base.querySelector('.base-name').textContent,
                            enabled: base.querySelector('input[type="checkbox"]').checked
                        })),
                        rpaStatus: document.querySelector('.rpa-settings .toggle-btn.active').textContent,
                        rpaFlows: Array.from(document.querySelectorAll('.rpa-flow')).map(flow => ({
                            name: flow.querySelector('.flow-name').textContent,
                            enabled: flow.querySelector('input[type="checkbox"]').checked,
                            trigger: flow.querySelector('.flow-trigger').textContent
                        }))
                    };
                    
                    console.log('策略设置已更新:', settings);
                    hideModal('strategyModal');
                });
                
                // 处理取消按钮
                document.querySelector('#strategyModal .cancel-btn').addEventListener('click', function() {
                    hideModal('strategyModal');
                });
            }

            // 初始化拖拽任务列表
            function initializeDraggableTasks() {
                const taskList = document.getElementById('draggableTaskList');
                const tasks = [
                    {
                        name: '19.9大促销',
                        status: 'running',
                        progress: 70,
                        calls: '3,500通',
                        startTime: '14:28:10',
                        endTime: '14:35:00'
                    },
                    {
                        name: '29.9特惠',
                        status: 'running',
                        progress: 45,
                        calls: '2,800通',
                        startTime: '14:28:20',
                        endTime: '14:36:10'
                    },
                    {
                        name: '会员回访计划',
                        status: 'pending',
                        progress: 25,
                        calls: '1,800通',
                        startTime: '14:28:30',
                        endTime: '14:37:25'
                    },
                    {
                        name: '季度满意度调查',
                        status: 'running',
                        progress: 60,
                        calls: '4,200通',
                        startTime: '14:28:40',
                        endTime: '14:38:15'
                    }
                ];

                // 清空现有内容
                taskList.innerHTML = '';

                // 创建任务卡片
                tasks.forEach(task => {
                    const taskCard = document.createElement('div');
                    taskCard.className = 'task-card';
                    taskCard.draggable = true;
                    taskCard.innerHTML = `
                        <div class="task-card-header">
                            <span class="task-name">${task.name}</span>
                            <span class="task-status ${task.status}">${task.status === 'running' ? '执行中' : '等待中'}</span>
                        </div>
                        <div class="task-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${task.progress}%"></div>
                            </div>
                        </div>
                        <div class="task-info">
                            <span>总量：${task.calls}</span>
                            <span>${task.startTime} - ${task.endTime}</span>
                        </div>
                    `;

                    // 添加拖拽事件监听器
                    taskCard.addEventListener('dragstart', handleDragStart);
                    taskCard.addEventListener('dragend', handleDragEnd);
                    taskCard.addEventListener('dragover', handleDragOver);
                    taskCard.addEventListener('drop', handleDrop);

                    taskList.appendChild(taskCard);
                });
            }

            // 更新变更策略按钮点击事件
            function initializeStrategyButtonEvents() {
                const strategyBtn = document.querySelector('.change-strategy-btn');
                // 添加null检查
                if (!strategyBtn) {
                    console.log('未找到变更策略按钮，跳过事件绑定');
                    return;
                }
                
                strategyBtn.addEventListener('click', function() {
                    const modal = document.getElementById('strategyModalFrame');
                    if (modal) {
                        modal.style.display = 'block';
                        createTaskCards();
                    }
                });
            }
            
            // 初始化函数中调用策略按钮初始化
            function initializeTaskModal() {
                // 添加try-catch块捕获可能的错误
                try {
                    if (document.getElementById('weeklyTimeGrid')) {
                        generateTimeGrid();
                    }
                    handleTagAddition();
                    handleShortcuts();
                    handleBlacklist();
                    handleIntervalSelection();
                    initializeStrategyControls(); // 添加策略控制初始化
                    initializeStrategyModal(); // 添加策略弹窗初始化
                    initializeStrategyButtonEvents(); // 添加策略按钮事件初始化
                    
                    // 复制任务名称
                    const copyTaskNameBtn = document.getElementById('copyTaskName');
                    if (copyTaskNameBtn) {
                        copyTaskNameBtn.addEventListener('click', () => {
                            const taskName = document.getElementById('taskName');
                            if (taskName) {
                                navigator.clipboard.writeText(taskName.value)
                                    .then(() => alert('任务名称已复制'))
                                    .catch(err => console.error('复制失败:', err));
                            }
                        });
                    }
                    
                    // 清空任务名称
                    const clearTaskNameBtn = document.getElementById('clearTaskName');
                    if (clearTaskNameBtn) {
                        clearTaskNameBtn.addEventListener('click', () => {
                            const taskName = document.getElementById('taskName');
                            if (taskName) {
                                taskName.value = '';
                            }
                        });
                    }
                    
                    // 提交表单
                    const submitBtn = document.querySelector('.submit-btn');
                    if (submitBtn) {
                        submitBtn.addEventListener('click', () => {
                            // TODO: 实现表单提交逻辑
                            alert('任务创建成功！');
                            hideAllModals();
                        });
                    }
                } catch (error) {
                    console.error('初始化任务模态窗口时出错:', error);
                }
            }

            // 拖拽事件处理函数
            function handleDragStart(e) {
                this.classList.add('dragging');
                e.dataTransfer.setData('text/plain', this.innerHTML);
                e.dataTransfer.effectAllowed = 'move';
                
                // 添加拖拽时的视觉效果
                requestAnimationFrame(() => {
                    this.style.opacity = '0.5';
                    document.querySelectorAll('.task-card').forEach(card => {
                        if (card !== this) {
                            card.style.transform = 'scale(0.98)';
                        }
                    });
                });
            }

            function handleDragEnd(e) {
                this.classList.remove('dragging');
                
                // 恢复所有卡片的样式
                requestAnimationFrame(() => {
                    this.style.opacity = '';
                    document.querySelectorAll('.task-card').forEach(card => {
                        card.style.transform = '';
                    });
                });
            }

            function handleDragOver(e) {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
                
                const draggingCard = document.querySelector('.dragging');
                const card = this;
                
                if (draggingCard !== card) {
                    const allCards = [...document.querySelectorAll('.task-card:not(.dragging)')];
                    const cardAfter = allCards.reduce((closest, child) => {
                        const box = child.getBoundingClientRect();
                        const offset = e.clientY - box.top - box.height / 2;
                        if (offset < 0 && offset > closest.offset) {
                            return { offset: offset, element: child };
                        } else {
                            return closest;
                        }
                    }, { offset: Number.NEGATIVE_INFINITY }).element;

                    if (cardAfter) {
                        cardAfter.parentNode.insertBefore(draggingCard, cardAfter);
                    } else {
                        card.parentNode.appendChild(draggingCard);
                    }
                }
            }

            function handleDrop(e) {
                e.preventDefault();
                const draggingCard = document.querySelector('.dragging');
                const dropTarget = this;
                
                if (draggingCard && dropTarget !== draggingCard) {
                    const allCards = [...document.querySelectorAll('.task-card')];
                    const dragIndex = allCards.indexOf(draggingCard);
                    const dropIndex = allCards.indexOf(dropTarget);
                    
                    if (dragIndex < dropIndex) {
                        dropTarget.parentNode.insertBefore(draggingCard, dropTarget.nextSibling);
                    } else {
                        dropTarget.parentNode.insertBefore(draggingCard, dropTarget);
                    }
                }
            }

            // 在页面加载完成后初始化所有功能
            document.addEventListener('DOMContentLoaded', function() {
                // ... existing initialization code ...
                initializeStrategyControls();
            });

            // 更新弹窗关闭事件处理
            document.addEventListener('DOMContentLoaded', function() {
                // ... existing initialization code ...

                // 处理弹窗关闭
                document.querySelectorAll('.close-modal-btn, .cancel-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const modal = this.closest('.modal');
                        if (modal) {
                            modal.style.display = 'none';
                        }
                    });
                });

                // 点击遮罩层关闭弹窗
                document.querySelectorAll('.modal-overlay').forEach(overlay => {
                    overlay.addEventListener('click', function(e) {
                        if (e.target === this) {
                            const modal = this.closest('.modal');
                            if (modal) {
                                modal.style.display = 'none';
                            }
                        }
                    });
                });

                // ESC键关闭弹窗
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape') {
                        const modals = document.querySelectorAll('.modal');
                        modals.forEach(modal => {
                            modal.style.display = 'none';
                        });
                    }
                });
            });

            // 确保DOM加载完成后初始化
            document.addEventListener('DOMContentLoaded', function() {
                // 初始化策略控件
                initializeStrategyControls();
                
                // 确保弹窗样式正确
                const modal = document.getElementById('newStrategyModal');
                if (modal) {
                    const container = modal.querySelector('.modal-container');
                    if (container) {
                        container.style.backgroundColor = '#fff';
                        container.style.zIndex = '10000';
                    }
                }
                
                // 处理弹窗关闭
                document.querySelectorAll('.close-modal-btn, .cancel-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const modal = this.closest('.modal');
                        if (modal) {
                            modal.style.display = 'none';
                        }
                    });
                });

                // 点击遮罩层关闭弹窗
                document.querySelectorAll('.modal-overlay').forEach(overlay => {
                    overlay.addEventListener('click', function(e) {
                        if (e.target === this) {
                            const modal = this.closest('.modal');
                            if (modal) {
                                modal.style.display = 'none';
                            }
                        }
                    });
                });

                // ESC键关闭弹窗
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape') {
                        const modals = document.querySelectorAll('.modal');
                        modals.forEach(modal => {
                            modal.style.display = 'none';
                        });
                    }
                });
            });

            // 关闭弹窗
            document.getElementById('closeStrategyModal').addEventListener('click', function() {
                document.getElementById('strategyModalFrame').style.display = 'none';
            });

            document.getElementById('cancelStrategyBtn').addEventListener('click', function() {
                document.getElementById('strategyModalFrame').style.display = 'none';
            });

            // 创建任务卡片
            function createTaskCards() {
                const taskList = document.getElementById('taskListContainer');
                if (!taskList) return;
                
                taskList.innerHTML = '';
                
                const tasks = [
                    {
                        name: '19.9大促销',
                        status: 'running',
                        progress: 70,
                        calls: '3,500通',
                        startTime: '14:28:10',
                        endTime: '14:35:00'
                    },
                    {
                        name: '29.9特惠',
                        status: 'running',
                        progress: 45,
                        calls: '2,800通',
                        startTime: '14:28:20',
                        endTime: '14:36:10'
                    },
                    {
                        name: '会员回访计划',
                        status: 'pending',
                        progress: 25,
                        calls: '1,800通',
                        startTime: '14:28:30',
                        endTime: '14:37:25'
                    },
                    {
                        name: '季度满意度调查',
                        status: 'running',
                        progress: 60,
                        calls: '4,200通',
                        startTime: '14:28:40',
                        endTime: '14:38:15'
                    }
                ];
                
                tasks.forEach(task => {
                    const taskCard = document.createElement('div');
                    taskCard.style.cssText = 'background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; cursor: move; transition: all 0.3s ease; position: relative;';
                    taskCard.draggable = true;
                    
                    const statusColor = task.status === 'running' ? '#e1f0ff' : '#fff7e6';
                    const statusTextColor = task.status === 'running' ? '#3498db' : '#f39c12';
                    const statusText = task.status === 'running' ? '执行中' : '等待中';
                    
                    taskCard.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <span style="font-size: 14px; font-weight: 500; color: #2c3e50;">${task.name}</span>
                            <span style="font-size: 12px; padding: 2px 8px; border-radius: 12px; background: ${statusColor}; color: ${statusTextColor};">${statusText}</span>
                        </div>
                        <div style="margin-top: 10px;">
                            <div style="height: 6px; background: #eee; border-radius: 3px; overflow: hidden;">
                                <div style="height: 100%; background: #3498db; border-radius: 3px; width: ${task.progress}%;"></div>
                            </div>
                        </div>
                        <div style="margin-top: 10px; display: flex; justify-content: space-between; font-size: 12px; color: #666;">
                            <span>总量：${task.calls}</span>
                            <span>${task.startTime} - ${task.endTime}</span>
                        </div>
                    `;
                    
                    // 添加拖拽事件
                    taskCard.addEventListener('dragstart', function(e) {
                        this.style.opacity = '0.5';
                        e.dataTransfer.setData('text/plain', this.innerHTML);
                    });
                    
                    taskCard.addEventListener('dragend', function() {
                        this.style.opacity = '1';
                    });
                    
                    taskCard.addEventListener('dragover', function(e) {
                        e.preventDefault();
                    });
                    
                    taskCard.addEventListener('drop', function(e) {
                        e.preventDefault();
                        const data = e.dataTransfer.getData('text/plain');
                        const draggedCard = document.querySelector('[style*="opacity: 0.5"]');
                        if (draggedCard && this !== draggedCard) {
                            const temp = this.innerHTML;
                            this.innerHTML = data;
                            draggedCard.innerHTML = temp;
                        }
                    });
                    
                    taskList.appendChild(taskCard);
                });
            }

            // 优先级按钮点击事件
            document.querySelectorAll('.priority-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.priority-btn').forEach(b => {
                        b.style.background = 'white';
                        b.style.color = '#666';
                        b.style.borderColor = '#ddd';
                    });
                    this.style.background = '#3498db';
                    this.style.color = 'white';
                    this.style.borderColor = '#3498db';
                });
            });

            // 并发设置按钮点击事件
            document.querySelectorAll('.concurrency-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const valueSpan = document.getElementById('concurrencyValue');
                    let value = parseInt(valueSpan.textContent);
                    
                    if (this.dataset.action === 'increase') {
                        value += 5;
                    } else {
                        value = Math.max(5, value - 5);
                    }
                    
                    valueSpan.textContent = value;
                });
            });

            // 保存按钮点击事件
            document.getElementById('saveStrategyBtn').addEventListener('click', function() {
                alert('策略已保存');
                document.getElementById('strategyModalFrame').style.display = 'none';
            });
            
            // 线索导入功能
            document.addEventListener('DOMContentLoaded', function() {
                // 身份与策略模块交互
                // 优先级按钮点击事件
                document.querySelectorAll('.priority-option-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.priority-option-btn').forEach(b => {
                            b.classList.remove('active');
                        });
                        this.classList.add('active');
                        
                        // 更新优先级描述
                        const priority = this.dataset.priority;
                        let description = '';
                        
                        switch(priority) {
                            case '独享':
                                description = '独享: 独占资源，最高优先级';
                                break;
                            case '优先':
                                description = '优先: 优先完成，适用于重要任务';
                                break;
                            case '正常':
                                description = '正常: 标准优先级，按序执行';
                                break;
                            case '滞后':
                                description = '滞后: 资源空闲时处理';
                                break;
                        }
                        
                        document.querySelector('.priority-desc').textContent = description;
                    });
                });
                
                // RPA开关事件
                const rpaSwitch = document.getElementById('rpaSwitch');
                const rpaProcess = document.getElementById('rpaProcess');
                
                if (rpaSwitch && rpaProcess) {
                    rpaSwitch.addEventListener('change', function() {
                        rpaProcess.disabled = !this.checked;
                    });
                }
                
                // 身份策略动态调整开关
                const dynamicIdentitySwitch = document.getElementById('dynamicIdentitySwitch');
                const identityStrategy = document.getElementById('identityStrategy');
                
                if (dynamicIdentitySwitch && identityStrategy) {
                    dynamicIdentitySwitch.addEventListener('change', function() {
                        if (this.checked) {
                            // 如果开启动态调整，自动选择"动态调整"选项
                            for (let i = 0; i < identityStrategy.options.length; i++) {
                                if (identityStrategy.options[i].value === 'dynamic') {
                                    identityStrategy.selectedIndex = i;
                                    break;
                                }
                            }
                        }
                    });
                    
                    identityStrategy.addEventListener('change', function() {
                        // 如果选择了"动态调整"，自动开启动态调整开关
                        if (this.value === 'dynamic') {
                            dynamicIdentitySwitch.checked = true;
                        }
                    });
                }
                
                // 公共线索池按钮点击事件
                const publicPoolBtn = document.querySelector('.import-card:nth-child(1) .import-card-btn');
                if (publicPoolBtn) {
                    publicPoolBtn.addEventListener('click', function() {
                        alert('即将打开公共线索池选择界面');
                        // 这里可以添加打开公共线索池选择界面的逻辑
                    });
                }
                
                // 外呼客户管理按钮点击事件
                const crmImportBtn = document.querySelector('.import-card:nth-child(2) .import-card-btn');
                if (crmImportBtn) {
                    crmImportBtn.addEventListener('click', function() {
                        alert('即将打开外呼客户管理导入界面');
                        // 这里可以添加打开外呼客户管理导入界面的逻辑
                    });
                }
                
                // 上传文件区域点击和拖拽事件
                const uploadArea = document.querySelector('.import-card-upload');
                const uploadBtn = document.querySelector('.import-card:nth-child(3) .import-card-btn');
                
                if (uploadArea) {
                    // 点击上传区域
                    uploadArea.addEventListener('click', function() {
                        // 创建一个隐藏的文件输入框
                        const fileInput = document.createElement('input');
                        fileInput.type = 'file';
                        fileInput.accept = '.xlsx,.csv';
                        fileInput.style.display = 'none';
                        
                        // 添加到DOM并触发点击
                        document.body.appendChild(fileInput);
                        fileInput.click();
                        
                        // 文件选择后的处理
                        fileInput.addEventListener('change', function() {
                            if (fileInput.files.length > 0) {
                                const fileName = fileInput.files[0].name;
                                alert(`已选择文件: ${fileName}`);
                                // 这里可以添加文件上传处理逻辑
                            }
                            
                            // 清理DOM
                            document.body.removeChild(fileInput);
                        });
                    });
                    
                    // 拖拽文件到上传区域
                    uploadArea.addEventListener('dragover', function(e) {
                        e.preventDefault();
                        uploadArea.style.backgroundColor = '#e1f0ff';
                        uploadArea.style.borderColor = '#3498db';
                    });
                    
                    uploadArea.addEventListener('dragleave', function(e) {
                        e.preventDefault();
                        uploadArea.style.backgroundColor = '#f8f9fa';
                        uploadArea.style.borderColor = '#ddd';
                    });
                    
                    uploadArea.addEventListener('drop', function(e) {
                        e.preventDefault();
                        uploadArea.style.backgroundColor = '#f8f9fa';
                        uploadArea.style.borderColor = '#ddd';
                        
                        if (e.dataTransfer.files.length > 0) {
                            const file = e.dataTransfer.files[0];
                            const fileName = file.name;
                            const fileExt = fileName.split('.').pop().toLowerCase();
                            
                            if (fileExt === 'xlsx' || fileExt === 'csv') {
                                alert(`已拖拽文件: ${fileName}`);
                                // 这里可以添加文件上传处理逻辑
                            } else {
                                alert('请上传 .xlsx 或 .csv 格式的文件');
                            }
                        }
                    });
                }
                
                // 上传按钮点击事件
                if (uploadBtn) {
                    uploadBtn.addEventListener('click', function() {
                        // 创建一个隐藏的文件输入框
                        const fileInput = document.createElement('input');
                        fileInput.type = 'file';
                        fileInput.accept = '.xlsx,.csv';
                        fileInput.style.display = 'none';
                        
                        // 添加到DOM并触发点击
                        document.body.appendChild(fileInput);
                        fileInput.click();
                        
                        // 文件选择后的处理
                        fileInput.addEventListener('change', function() {
                            if (fileInput.files.length > 0) {
                                const fileName = fileInput.files[0].name;
                                alert(`已选择文件: ${fileName}`);
                                // 这里可以添加文件上传处理逻辑
                            }
                            
                            // 清理DOM
                            document.body.removeChild(fileInput);
                        });
                    });
                }
            });

            // 弹窗控制函数
            function showModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('show');
                }
            }

            // 关闭弹窗事件监听
            document.querySelectorAll('.modal').forEach(modal => {
                const closeBtn = modal.querySelector('.close-modal');
                const overlay = modal.querySelector('.modal-overlay');
                
                if (closeBtn) {
                    closeBtn.addEventListener('click', () => {
                        modal.classList.remove('show');
                    });
                }
                
                if (overlay) {
                    overlay.addEventListener('click', () => {
                        modal.classList.remove('show');
                    });
                }
            });

            // 统计卡片悬停效果
            document.querySelectorAll('.stat-card.clickable').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px)';
                    this.style.boxShadow = '0 4px 8px rgba(0,0,0,0.1)';
                });

                card.addEventListener('mouseleave', function() {
                    this.style.transform = '';
                    this.style.boxShadow = '';
                });
            });

            // Handle pause/play button clicks
            document.addEventListener('DOMContentLoaded', function() {
                document.querySelectorAll('.fa-pause, .fa-play').forEach(icon => {
                    icon.parentElement.addEventListener('click', function() {
                        const button = this;
                        const icon = button.querySelector('i');
                        
                        if (icon.classList.contains('fa-pause')) {
                            // Change to play button
                            icon.classList.remove('fa-pause');
                            icon.classList.add('fa-play');
                            button.style.background = 'rgba(46, 204, 113, 0.1)';
                            button.style.color = '#2ecc71';
                        } else {
                            // Change to pause button
                            icon.classList.remove('fa-play');
                            icon.classList.add('fa-pause');
                            button.style.background = 'rgba(231, 76, 60, 0.1)';
                            button.style.color = '#e74c3c';
                        }
                    });
                });
            });

            // 确保页面加载完成后执行
            document.addEventListener('DOMContentLoaded', function() {
                // 导出报告弹窗功能
                const exportBtn = document.getElementById('exportReportBtn');
                const exportPopup = document.getElementById('exportOptionsPopup');
                const popupOverlay = document.getElementById('popupOverlay');
                
                if (exportBtn && exportPopup && popupOverlay) {
                    console.log('找到导出按钮和弹窗元素'); // 调试用
                    exportBtn.addEventListener('click', function(e) {
                        console.log('导出按钮被点击'); // 调试用
                        e.preventDefault(); // 阻止默认行为
                        e.stopPropagation(); // 阻止事件冒泡
                        
                        // 获取按钮位置并定位弹窗
                        const btnRect = exportBtn.getBoundingClientRect();
                        exportPopup.style.top = (btnRect.bottom + window.scrollY + 5) + 'px';
                        exportPopup.style.left = (btnRect.left + window.scrollX) + 'px';
                        
                        // 显示弹窗和遮罩层
                        exportPopup.style.display = 'block';
                        popupOverlay.style.display = 'block';
                    });
                    
                    // 点击遮罩层关闭弹窗
                    popupOverlay.addEventListener('click', function() {
                        exportPopup.style.display = 'none';
                        popupOverlay.style.display = 'none';
                    });
                    
                    // 阻止弹窗点击事件冒泡
                    exportPopup.addEventListener('click', function(e) {
                        e.stopPropagation();
                    });
                    
                    // 点击文档其他地方关闭弹窗
                    document.addEventListener('click', function() {
                        exportPopup.style.display = 'none';
                        popupOverlay.style.display = 'none';
                    });
                } else {
                    console.log('未找到导出按钮或弹窗元素'); // 调试用
                    if (!exportBtn) console.log('未找到exportBtn');
                    if (!exportPopup) console.log('未找到exportPopup');
                    if (!popupOverlay) console.log('未找到popupOverlay');
                }
                
                // 导出报告功能
                window.exportReport = function(type) {
                    let message = '';
                    
                    switch(type) {
                        case 'excel':
                            message = '开始导出Excel表格...';
                            break;
                        case 'pdf':
                            message = '开始导出PDF文档...';
                            break;
                        case 'csv':
                            message = '开始导出CSV格式...';
                            break;
                        case 'print':
                            message = '准备打印报告...';
                            break;
                    }
                    
                    alert(message);
                    
                    // 关闭弹窗
                    document.getElementById('exportOptionsPopup').style.display = 'none';
                    document.getElementById('popupOverlay').style.display = 'none';
                };
            });

            // 更新变更策略按钮点击事件
            const strategyBtn = document.querySelector('.change-strategy-btn');
            // 添加null检查，防止错误
            if (strategyBtn) {
                strategyBtn.addEventListener('click', function() {
                    const modal = document.getElementById('strategyModalFrame');
                    if (modal) {
                        modal.style.display = 'block';
                        createTaskCards();
                    }
                });
            } else {
                console.log('未找到变更策略按钮，跳过事件绑定');
            }

            // 初始化策略设置控件
            // ... existing code ...
        </script>
    </body>
</html> 